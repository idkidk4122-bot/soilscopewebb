<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoilScope | NASA-Powered Agricultural Intelligence</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGuOODqC6pVzHzZBdQ9dZx5GBkjJUHWMU&libraries=places"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary-olive: #2E8B57;
            --secondary-olive: #3CB371;
            --primary-beige: #F5F5DC;
            --secondary-beige: #FFF8DC;
            --primary-brown: #8B4513;
            --secondary-brown: #A0522D;
            --aqua-blue: #20B2AA;
            --secondary-aqua: #48D1CC;
            --white: #ffffff;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --bg-color: #f8f9fa;
            --text-color: #343a40;
            --card-bg: #ffffff;
            --header-bg: #ffffff;
            --footer-bg: #ffffff;
            --border-color: #dee2e6;
            --sidebar-bg: #2E8B57;
            --sidebar-width: 260px;
            --sidebar-collapsed-width: 80px;
            --transition-speed: 0.3s;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-color: #1a1d23;
            --text-color: #e9ecef;
            --card-bg: #2d333b;
            --header-bg: #2d333b;
            --footer-bg: #2d333b;
            --border-color: #444c56;
            --light-gray: #343a40;
            --sidebar-bg: #1e6b4e;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 10px 15px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Language Selector */
        .language-selector {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
        }

        .language-btn {
            padding: 10px 15px;
            background: var(--primary-olive);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .language-btn:hover {
            background: var(--secondary-olive);
            transform: translateY(-2px);
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 5px;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-hover);
            overflow: hidden;
            width: 150px;
            display: none;
            z-index: 1002;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .language-option:hover {
            background-color: var(--light-gray);
        }

        .language-option.active {
            background-color: var(--primary-olive);
            color: white;
        }
        
        .login-container {
            display: flex;
            min-height: 100vh;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        /* NEW: Animated Login Background */
        .login-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(-45deg, #87CEEB, #90EE90, #20B2AA, #3CB371);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            z-index: -2;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .floating-shapes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }

        .shape {
            position: absolute;
            opacity: 0.3;
            animation: float 20s infinite linear;
        }

        .shape:nth-child(1) {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            top: 10%;
            left: 10%;
            border-radius: 50%;
            animation-delay: 0s;
        }

        .shape:nth-child(2) {
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.15);
            top: 70%;
            left: 80%;
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            animation-delay: -5s;
        }

        .shape:nth-child(3) {
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            top: 30%;
            left: 70%;
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            animation-delay: -10s;
        }

        .shape:nth-child(4) {
            width: 90px;
            height: 90px;
            background: rgba(255, 255, 255, 0.2);
            top: 80%;
            left: 20%;
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            animation-delay: -15s;
        }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(20px, 20px) rotate(90deg); }
            50% { transform: translate(0, 40px) rotate(180deg); }
            75% { transform: translate(-20px, 20px) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        .login-card {
            background-color: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-hover);
            width: 100%;
            max-width: 420px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            z-index: 1;
            border: 3px solid var(--primary-olive);
        }

        .login-logo {
            margin-bottom: 30px;
        }

        .login-logo i {
            font-size: 48px;
            color: var(--primary-olive);
            margin-bottom: 15px;
        }

        .login-logo h1 {
            font-size: 32px;
            color: var(--primary-olive);
            margin-bottom: 5px;
        }

        .login-form {
            text-align: left;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background-color: var(--card-bg);
            color: var(--text-color);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-olive);
            box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.2);
        }

        .login-btn {
            width: 100%;
            padding: 14px;
            background-color: var(--primary-olive);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .login-btn:hover {
            background-color: var(--secondary-olive);
            transform: translateY(-2px);
        }

        /* NEW: Show Password Toggle */
        .password-container {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            font-size: 16px;
        }

        /* NEW: Create Account Form */
        .create-account-form {
            display: none;
            text-align: left;
        }

        .create-account-form.active {
            display: block;
        }

        .form-footer {
            margin-top: 20px;
            text-align: center;
        }

        .form-footer a {
            color: var(--primary-olive);
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }

        .form-footer a:hover {
            text-decoration: underline;
        }

        /* NASA Badge */
        .nasa-badge {
            background: linear-gradient(135deg, #0b3d91, #fc3d21);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .nasa-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            margin-left: 10px;
        }

        .nasa-status.active {
            background-color: rgba(46, 139, 87, 0.1);
            color: var(--primary-olive);
            border: 1px solid var(--primary-olive);
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }

        .theme-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-olive);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .theme-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: var(--shadow-hover);
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: var(--sidebar-width);
            background-color: var(--sidebar-bg);
            box-shadow: var(--shadow);
            transition: all var(--transition-speed) ease;
            z-index: 999;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .sidebar.collapsed {
            width: var(--sidebar-collapsed-width);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition-speed) ease;
        }

        .sidebar.collapsed .sidebar-header {
            justify-content: center;
            padding: 25px 10px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .logo-icon {
            color: var(--primary-beige);
            font-size: 28px;
            transition: all var(--transition-speed) ease;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-beige);
            transition: all var(--transition-speed) ease;
        }

        .logo-text span {
            color: var(--aqua-blue);
        }

        .sidebar.collapsed .logo-text {
            opacity: 0;
            width: 0;
        }

        .sidebar-menu {
            list-style: none;
            padding: 20px 0;
        }

        .sidebar-item {
            margin-bottom: 5px;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            text-decoration: none;
            color: var(--primary-beige);
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .sidebar-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-left-color: var(--aqua-blue);
        }

        .sidebar-link.active {
            background-color: rgba(255, 255, 255, 0.15);
            border-left-color: var(--primary-beige);
            color: white;
        }

        .sidebar-icon {
            font-size: 20px;
            margin-right: 15px;
            min-width: 24px;
            text-align: center;
            transition: all var(--transition-speed) ease;
        }

        .sidebar.collapsed .sidebar-icon {
            margin-right: 0;
        }

        .sidebar-text {
            font-weight: 500;
            transition: all var(--transition-speed) ease;
        }

        .sidebar.collapsed .sidebar-text {
            opacity: 0;
            width: 0;
        }

        /* NEW: Language Selector in Sidebar */
        .sidebar-language-selector {
            position: absolute;
            bottom: 80px;
            left: 20px;
            right: 20px;
            z-index: 1000;
        }

        .sidebar.collapsed .sidebar-language-selector {
            display: flex;
            justify-content: center;
        }

        .sidebar-language-btn {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--primary-beige);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .sidebar.collapsed .sidebar-language-btn {
            width: auto;
            padding: 12px;
            justify-content: center;
        }

        .sidebar-language-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .sidebar-language-text {
            transition: all var(--transition-speed) ease;
        }

        .sidebar.collapsed .sidebar-language-text {
            opacity: 0;
            width: 0;
            display: none;
        }

        .sidebar-language-dropdown {
            position: absolute;
            bottom: 100%;
            left: 0;
            margin-bottom: 5px;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-hover);
            overflow: hidden;
            width: 100%;
            display: none;
            z-index: 1002;
        }

        .sidebar-language-dropdown.show {
            display: block;
        }

        .toggle-sidebar {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: var(--primary-beige);
            color: var(--primary-olive);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-sidebar:hover {
            background: var(--aqua-blue);
            transform: scale(1.05);
        }

        .sidebar.collapsed .toggle-sidebar {
            left: 20px;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            transition: margin-left var(--transition-speed) ease;
            min-height: 100vh;
            background-color: var(--bg-color);
        }

        .main-content.expanded {
            margin-left: var(--sidebar-collapsed-width);
        }

        /* Header */
        header {
            background-color: var(--header-bg);
            box-shadow: var(--shadow);
            padding: 20px 0;
            transition: background-color 0.3s ease;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .page-title {
            font-size: 28px;
            color: var(--primary-olive);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-info {
            color: var(--text-color);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-olive);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* NEW: Header Logout Button */
        .header-logout-btn {
            padding: 8px 15px;
            background-color: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
            margin-left: 15px;
        }

        .header-logout-btn:hover {
            background-color: rgba(231, 76, 60, 0.2);
            transform: translateY(-2px);
        }

        /* Main */
        main {
            padding: 30px 20px;
            min-height: calc(100vh - 160px);
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dashboard */
        .dashboard-header {
            margin-bottom: 30px;
        }

        .dashboard-title {
            font-size: 32px;
            color: var(--primary-olive);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            border-top: 5px solid var(--primary-olive);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .stat-card.soil {
            border-top-color: var(--primary-brown);
        }

        .stat-card.water {
            border-top-color: var(--aqua-blue);
        }

        .stat-card.air {
            border-top-color: var(--primary-olive);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--white);
        }

        .soil-icon {
            background-color: var(--primary-brown);
        }

        .water-icon {
            background-color: var(--aqua-blue);
        }

        .air-icon {
            background-color: var(--primary-olive);
        }

        .stat-info h3 {
            font-size: 24px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stat-info p {
            color: #777;
            font-size: 14px;
        }

        .progress-bar {
            height: 8px;
            background-color: var(--light-gray);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-olive), var(--aqua-blue));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .map-container {
            background-color: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            position: relative;
            transition: background-color 0.3s ease;
        }

        .map-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .map-title {
            font-size: 20px;
            color: var(--primary-olive);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .map-controls {
            display: flex;
            gap: 10px;
        }

        .map-btn {
            padding: 10px 15px;
            background-color: var(--light-gray);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-color);
            font-weight: 500;
        }

        .map-btn:hover {
            background-color: var(--border-color);
            transform: translateY(-2px);
        }

        .map-content {
            height: 500px;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .location-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            width: 300px;
            z-index: 10;
            transition: background-color 0.3s ease;
        }

        .location-title {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--primary-olive);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .location-data {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .location-label {
            color: #777;
        }

        .location-value {
            font-weight: 500;
            color: var(--text-color);
        }

        .more-info-btn {
            width: 100%;
            margin-top: 15px;
            background-color: var(--primary-olive);
            color: white;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .more-info-btn:hover {
            background-color: var(--secondary-olive);
            transform: translateY(-2px);
        }

        /* Analysis */
        .analysis-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 25px;
            background-color: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-color);
        }

        .tab-btn.active {
            color: var(--primary-olive);
            border-bottom: 3px solid var(--primary-olive);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        .analysis-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            transition: background-color 0.3s ease;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 20px;
            color: var(--primary-olive);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .status-good {
            background-color: rgba(46, 139, 87, 0.1);
            color: var(--primary-olive);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .metric {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            background-color: var(--light-gray);
            transition: background-color 0.3s ease, transform 0.2s;
        }

        .metric:hover {
            transform: translateY(-5px);
        }

        .metric-value {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .soil .metric-value {
            color: var(--primary-brown);
        }

        .water .metric-value {
            color: var(--aqua-blue);
        }

        .air .metric-value {
            color: var(--primary-olive);
        }

        .metric-label {
            font-size: 14px;
            color: #777;
        }

        .chart-container {
            height: 300px;
            margin-top: 20px;
        }

        /* Recommendations */
        .carousel-container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .carousel {
            display: flex;
            transition: transform 0.5s ease;
        }

        .carousel-item {
            min-width: 100%;
            padding: 40px;
            background-color: var(--card-bg);
            text-align: center;
        }

        .crop-emoji {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .crop-name {
            font-size: 24px;
            color: var(--primary-olive);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .crop-description {
            color: var(--text-color);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .nasa-data {
            background: rgba(11, 61, 145, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
        }

        .nasa-data h4 {
            color: #0b3d91;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nasa-data ul {
            list-style: none;
            padding-left: 0;
        }

        .nasa-data li {
            padding: 5px 0;
            border-bottom: 1px solid rgba(11, 61, 145, 0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .carousel-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .carousel-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--border-color);
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .carousel-btn.active {
            background-color: var(--primary-olive);
        }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(255, 255, 255, 0.7);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            color: var(--primary-olive);
            transition: all 0.3s;
        }

        .carousel-nav:hover {
            background-color: var(--primary-olive);
            color: white;
        }

        .carousel-prev {
            left: 10px;
        }

        .carousel-next {
            right: 10px;
        }

        /* CropLens AI */
        .ai-assistant-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            transition: background-color 0.3s ease;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .ai-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-olive), var(--aqua-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .ai-title {
            font-size: 24px;
            color: var(--primary-olive);
        }

        .chat-container {
            background-color: var(--light-gray);
            border-radius: 12px;
            padding: 20px;
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 10px;
        }

        .message {
            padding: 12px 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .user-message {
            background-color: var(--primary-olive);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .ai-message {
            background-color: var(--card-bg);
            color: var(--text-color);
            border-bottom-left-radius: 4px;
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--card-bg);
            color: var(--text-color);
            font-size: 16px;
        }

        .send-btn {
            padding: 12px 20px;
            background-color: var(--primary-olive);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .send-btn:hover {
            background-color: var(--secondary-olive);
        }

        /* Market Trends */
        .market-trends-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .market-trends-title {
            font-size: 32px;
            color: var(--primary-olive);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .price-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .price-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: floatCard 3s ease-in-out infinite;
            cursor: pointer;
        }

        .price-card.active {
            border: 2px solid var(--primary-olive);
            box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.2);
        }

        @keyframes floatCard {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .price-card:nth-child(1) { animation-delay: 0s; }
        .price-card:nth-child(2) { animation-delay: 0.2s; }
        .price-card:nth-child(3) { animation-delay: 0.4s; }
        .price-card:nth-child(4) { animation-delay: 0.6s; }
        .price-card:nth-child(5) { animation-delay: 0.8s; }
        .price-card:nth-child(6) { animation-delay: 1s; }

        .price-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .price-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .price-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-olive);
        }

        .price-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .price-change {
            font-size: 14px;
            font-weight: 500;
            padding: 3px 8px;
            border-radius: 12px;
            display: inline-block;
        }

        .price-up {
            background-color: rgba(46, 139, 87, 0.1);
            color: var(--primary-olive);
        }

        .price-down {
            background-color: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }

        .timeframe-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .timeframe-btn {
            padding: 8px 16px;
            background-color: var(--light-gray);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-color);
            font-weight: 500;
        }

        .timeframe-btn.active {
            background-color: var(--primary-olive);
            color: white;
        }

        .market-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
        }

        .chart-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: background-color 0.3s ease;
        }

        .chart-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-card-title {
            font-size: 18px;
            color: var(--primary-olive);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-card-container {
            height: 300px;
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 15px 25px;
            background-color: var(--primary-olive);
            color: white;
            border-radius: 5px;
            box-shadow: var(--shadow);
            z-index: 1001;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background-color: #e74c3c;
        }

        /* Level Badge */
        .level-badge {
            display: inline-block;
            padding: 4px 10px;
            background-color: var(--primary-olive);
            color: white;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        /* NEW: Account Page Styles */
        .account-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 500px;
            margin: 0 auto;
            transition: background-color 0.3s ease;
        }

        .account-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .account-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-olive), var(--aqua-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: bold;
        }

        .account-info {
            flex: 1;
        }

        .account-name {
            font-size: 24px;
            color: var(--primary-olive);
            margin-bottom: 5px;
        }

        .account-details {
            margin-bottom: 30px;
        }

        .account-field {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .account-label {
            font-weight: 500;
            color: var(--text-color);
        }

        .account-value {
            color: var(--text-color);
        }

        .logout-btn {
            width: 100%;
            padding: 14px;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .logout-btn:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .sidebar {
                width: var(--sidebar-collapsed-width);
            }

            .sidebar-header {
                justify-content: center;
                padding: 20px 10px;
            }

            .logo-text {
                opacity: 0;
                width: 0;
            }

            .sidebar-text {
                opacity: 0;
                width: 0;
            }

            .sidebar-icon {
                margin-right: 0;
            }

            .main-content {
                margin-left: var(--sidebar-collapsed-width);
            }

            .header-container {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .map-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .location-info {
                position: relative;
                bottom: auto;
                left: auto;
                width: 100%;
                margin-top: 20px;
            }

            .theme-toggle {
                top: 80px;
                right: 10px;
            }

            .theme-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .language-selector {
                top: 80px;
                left: 10px;
            }

            .carousel-nav {
                display: none;
            }

            .analysis-tabs {
                flex-direction: column;
            }

            .tab-btn {
                text-align: left;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .stats-cards {
                grid-template-columns: 1fr;
            }

            .market-charts {
                grid-template-columns: 1fr;
            }

            .price-cards {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-background"></div>
        <div class="floating-shapes">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>
        
        <!-- Login Form -->
        <div class="login-card">
            <div class="login-logo">
                <i class="fas fa-seedling"></i>
                <h1 data-i18n="app_title">Soil<span>Scope</span></h1>
                <p data-i18n="app_subtitle">NASA-Powered Agricultural Intelligence</p>
                <div class="nasa-status active">
                    <i class="fas fa-satellite"></i> <span data-i18n="nasa_connected">NASA API Connected</span>
                </div>
            </div>
            
            <!-- Login Form -->
            <form class="login-form" id="login-form">
                <div class="form-group">
                    <label for="username" data-i18n="username_label">Username</label>
                    <input type="text" id="username" class="form-control" data-i18n-placeholder="username_placeholder" placeholder="Enter your username" required>
                </div>
                <div class="form-group">
                    <label for="password" data-i18n="password_label">Password</label>
                    <div class="password-container">
                        <input type="password" id="password" class="form-control" data-i18n-placeholder="password_placeholder" placeholder="Enter your password" required>
                        <button type="button" class="toggle-password" id="toggle-login-password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <button type="submit" class="login-btn" data-i18n="sign_in">Sign In</button>
            </form>
            
            <!-- Create Account Form -->
            <form class="create-account-form" id="create-account-form">
                <div class="form-group">
                    <label for="new-username" data-i18n="username_label">Username</label>
                    <input type="text" id="new-username" class="form-control" data-i18n-placeholder="username_placeholder" placeholder="Enter your username" required>
                </div>
                <div class="form-group">
                    <label for="new-password" data-i18n="password_label">Password</label>
                    <div class="password-container">
                        <input type="password" id="new-password" class="form-control" data-i18n-placeholder="password_placeholder" placeholder="Enter your password" required>
                        <button type="button" class="toggle-password" id="toggle-new-password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="confirm-password" data-i18n="confirm_password">Confirm Password</label>
                    <div class="password-container">
                        <input type="password" id="confirm-password" class="form-control" placeholder="Confirm your password" required>
                        <button type="button" class="toggle-password" id="toggle-confirm-password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <button type="submit" class="login-btn" data-i18n="create_account">Create Account</button>
            </form>
            
            <div class="form-footer">
                <p id="form-toggle-text" data-i18n="no_account">Don't have an account? <a href="#" id="form-toggle-link" data-i18n="create_account_link">Create Account</a></p>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" style="display: none;">
        <!-- Toast -->
        <div id="toast" class="toast"></div>

        <!-- Theme Toggle -->
        <div class="theme-toggle">
            <button id="theme-btn" class="theme-btn">
                <i class="fas fa-moon"></i>
            </button>
        </div>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="#" class="logo">
                    <i class="fas fa-seedling logo-icon"></i>
                    <div class="logo-text" data-i18n="app_title">Soil<span>Scope</span></div>
                </a>
            </div>
            <ul class="sidebar-menu">
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link active" data-page="dashboard">
                        <i class="fas fa-tachometer-alt sidebar-icon"></i>
                        <span class="sidebar-text" data-i18n="dashboard">Dashboard</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" data-page="analysis">
                        <i class="fas fa-chart-bar sidebar-icon"></i>
                        <span class="sidebar-text" data-i18n="analysis">Analysis</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" data-page="recommendations">
                        <i class="fas fa-leaf sidebar-icon"></i>
                        <span class="sidebar-text" data-i18n="recommendations">Recommendations</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" data-page="crop-lens">
                        <i class="fas fa-robot sidebar-icon"></i>
                        <span class="sidebar-text" data-i18n="crop_lens">CropLens AI</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" data-page="market-trends">
                        <i class="fas fa-chart-line sidebar-icon"></i>
                        <span class="sidebar-text" data-i18n="market_trends">Market Trends</span>
                    </a>
                </li>
                <!-- NEW: Account Tab -->
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" data-page="account">
                        <i class="fas fa-user-circle sidebar-icon"></i>
                        <span class="sidebar-text" data-i18n="account">Account</span>
                    </a>
                </li>
            </ul>
            
            <!-- NEW: Language Selector in Sidebar -->
            <div class="sidebar-language-selector">
                <button class="sidebar-language-btn" id="sidebar-language-btn">
                    <i class="fas fa-globe"></i>
                    <span class="sidebar-language-text" id="sidebar-language-text">English</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="sidebar-language-dropdown" id="sidebar-language-dropdown">
                    <div class="language-option" data-lang="en">English</div>
                    <div class="language-option" data-lang="es">Espaol</div>
                    <div class="language-option" data-lang="fr">Franais</div>
                    <div class="language-option" data-lang="hi"></div>
                    <div class="language-option" data-lang="pa"></div>
                </div>
            </div>
            
            <button class="toggle-sidebar" id="toggle-sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <!-- Header -->
            <header>
                <div class="header-container">
                    <h1 class="page-title">
                        <span data-i18n="dashboard">Dashboard</span>
                        <span class="nasa-badge">
                            <i class="fas fa-satellite"></i> <span data-i18n="nasa_powered">NASA POWERED</span>
                        </span>
                    </h1>
                    <div class="user-info">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <span id="user-name">User</span>
                        <span class="level-badge" data-i18n="level">Level 5</span>
                        <div class="nasa-status active" id="nasa-status">
                            <i class="fas fa-satellite"></i> <span data-i18n="nasa_online">NASA ONLINE</span>
                        </div>
                        <!-- NEW: Logout Button in Header -->
                        <button class="header-logout-btn" id="header-logout-btn">
                            <i class="fas fa-sign-out-alt"></i> <span data-i18n="logout">Logout</span>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main>
                <!-- Dashboard Page -->
                <section id="dashboard" class="page active">
                    <div class="container">
                        <div class="dashboard-header">
                            <h1 class="dashboard-title">
                                <span data-i18n="farm_analysis">Farm Analysis Dashboard</span>
                                <span class="nasa-badge" data-i18n="nasa_satellite">NASA SATELLITE DATA</span>
                            </h1>
                            <p data-i18n="dashboard_description">Monitor your soil, water, and air conditions with real-time NASA satellite data</p>
                        </div>
                        
                        <div class="stats-cards">
                            <div class="stat-card soil" data-tab="soil">
                                <div class="stat-icon soil-icon">
                                    <i class="fas fa-mountain"></i>
                                </div>
                                <div class="stat-info">
                                    <h3><span data-i18n="soil_health">Soil Health</span> <span class="nasa-badge">NASA</span></h3>
                                    <p data-i18n="optimal_conditions">Optimal Conditions</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 92%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-card water" data-tab="water">
                                <div class="stat-icon water-icon">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <div class="stat-info">
                                    <h3><span data-i18n="water_quality">Water Quality</span> <span class="nasa-badge">NASA</span></h3>
                                    <p data-i18n="good_level">Good Level</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 78%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-card air" data-tab="air">
                                <div class="stat-icon air-icon">
                                    <i class="fas fa-wind"></i>
                                </div>
                                <div class="stat-info">
                                    <h3><span data-i18n="air_quality">Air Quality</span> <span class="nasa-badge">NASA</span></h3>
                                    <p data-i18n="excellent">Excellent</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 95%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="map-container">
                            <div class="map-header">
                                <h2 class="map-title">
                                    <span data-i18n="farm_location">Farm Location & Analysis</span> 
                                    <span class="nasa-badge" data-i18n="live_satellite">LIVE SATELLITE</span>
                                </h2>
                                <div class="map-controls">
                                    <button class="map-btn" id="search-location">
                                        <i class="fas fa-search-location"></i> <span data-i18n="search">Search</span>
                                    </button>
                                    <button class="map-btn" id="get-current-location">
                                        <i class="fas fa-location-arrow"></i> <span data-i18n="my_location">My Location</span>
                                    </button>
                                    <button class="map-btn" id="fetch-nasa-data">
                                        <i class="fas fa-satellite"></i> <span data-i18n="fetch_nasa">Fetch NASA Data</span>
                                    </button>
                                    <button class="map-btn" id="save-location">
                                        <i class="fas fa-save"></i> <span data-i18n="save_location">Save Location</span>
                                    </button>
                                </div>
                            </div>
                            <div class="map-content">
                                <div id="map"></div>
                                <div class="location-info">
                                    <h4 class="location-title">
                                        <i class="fas fa-map-marker-alt"></i> <span data-i18n="current_location">Current Location</span>
                                        <span class="nasa-badge" data-i18n="live">LIVE</span>
                                    </h4>
                                    <div class="location-data">
                                        <span class="location-label" data-i18n="latitude">Latitude:</span>
                                        <span class="location-value" id="latitude">Loading...</span>
                                    </div>
                                    <div class="location-data">
                                        <span class="location-label" data-i18n="longitude">Longitude:</span>
                                        <span class="location-value" id="longitude">Loading...</span>
                                    </div>
                                    <div class="location-data">
                                        <span class="location-label" data-i18n="address">Address:</span>
                                        <span class="location-value" id="address">Loading...</span>
                                    </div>
                                    <div class="location-data">
                                        <span class="location-label" data-i18n="ndvi_index">NDVI Index:</span>
                                        <span class="location-value" id="ndvi-value">0.72</span>
                                    </div>
                                    <div class="location-data">
                                        <span class="location-label" data-i18n="soil_moisture">Soil Moisture:</span>
                                        <span class="location-value" id="soil-moisture">38%</span>
                                    </div>
                                    <button class="more-info-btn" id="more-info-btn">
                                        <i class="fas fa-chart-bar"></i> <span data-i18n="detailed_analysis">Detailed Analysis</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Analysis Page -->
                <section id="analysis" class="page">
                    <div class="container">
                        <div class="dashboard-header">
                            <h1 class="dashboard-title">
                                <span data-i18n="detailed_analysis">Detailed Analysis</span> 
                                <span class="nasa-badge" data-i18n="nasa_data">NASA DATA</span>
                            </h1>
                            <p data-i18n="analysis_description">Comprehensive breakdown of soil, water, and air conditions using NASA satellite data</p>
                            <div class="analysis-location">
                                <i class="fas fa-map-marker-alt"></i>
                                <span id="analysis-location-text" data-i18n="analyzing_data">Analyzing data for your selected location</span>
                            </div>
                        </div>
                        
                        <div class="analysis-tabs">
                            <button class="tab-btn active" data-tab="soil" data-i18n="soil_analysis">Soil Analysis</button>
                            <button class="tab-btn" data-tab="water" data-i18n="water_analysis">Water Analysis</button>
                            <button class="tab-btn" data-tab="air" data-i18n="air_analysis">Air Analysis</button>
                            <button class="tab-btn" data-tab="satellite" data-i18n="satellite_data">Satellite Data</button>
                        </div>
                        
                        <!-- Soil Tab -->
                        <div id="soil-tab" class="tab-content active">
                            <div class="analysis-card">
                                <div class="card-header">
                                    <h2 class="card-title">
                                        <span data-i18n="soil_health_overview">Soil Health Overview</span> 
                                        <span class="nasa-badge">NASA SMAP</span>
                                    </h2>
                                    <div class="card-status status-good" data-i18n="optimal">Optimal</div>
                                </div>
                                <div class="metrics-grid">
                                    <div class="metric soil">
                                        <div class="metric-value" id="soil-ph">6.5 pH</div>
                                        <div class="metric-label" data-i18n="acidity_level">Acidity Level</div>
                                    </div>
                                    <div class="metric soil">
                                        <div class="metric-value" id="soil-moisture-analysis">38%</div>
                                        <div class="metric-label" data-i18n="moisture_content">Moisture Content</div>
                                    </div>
                                    <div class="metric soil">
                                        <div class="metric-value" id="soil-organic">4.2%</div>
                                        <div class="metric-label" data-i18n="organic_matter">Organic Matter</div>
                                    </div>
                                    <div class="metric soil">
                                        <div class="metric-value" id="soil-nutrients">High</div>
                                        <div class="metric-label" data-i18n="nutrient_level">Nutrient Level</div>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="soilPieChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Water Tab -->
                        <div id="water-tab" class="tab-content">
                            <div class="analysis-card">
                                <div class="card-header">
                                    <h2 class="card-title">
                                        <span data-i18n="water_quality_overview">Water Quality Overview</span> 
                                        <span class="nasa-badge">NASA GRACE</span>
                                    </h2>
                                    <div class="card-status status-good" data-i18n="good">Good</div>
                                </div>
                                <div class="metrics-grid">
                                    <div class="metric water">
                                        <div class="metric-value" id="water-ph">7.1 pH</div>
                                        <div class="metric-label" data-i18n="water_acidity">Water Acidity</div>
                                    </div>
                                    <div class="metric water">
                                        <div class="metric-value" id="water-tds">85 ppm</div>
                                        <div class="metric-label" data-i18n="dissolved_solids">Total Dissolved Solids</div>
                                    </div>
                                    <div class="metric water">
                                        <div class="metric-value" id="water-nitrates">0.5 mg/L</div>
                                        <div class="metric-label" data-i18n="nitrate_level">Nitrate Level</div>
                                    </div>
                                    <div class="metric water">
                                        <div class="metric-value" id="water-quality">Excellent</div>
                                        <div class="metric-label" data-i18n="bacterial_quality">Bacterial Quality</div>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="waterBarChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Air Tab -->
                        <div id="air-tab" class="tab-content">
                            <div class="analysis-card">
                                <div class="card-header">
                                    <h2 class="card-title">
                                        <span data-i18n="air_quality_overview">Air Quality Overview</span> 
                                        <span class="nasa-badge">NASA MODIS</span>
                                    </h2>
                                    <div class="card-status status-good" data-i18n="excellent">Excellent</div>
                                </div>
                                <div class="metrics-grid">
                                    <div class="metric air">
                                        <div class="metric-value" id="air-aqi">15 AQI</div>
                                        <div class="metric-label" data-i18n="air_quality_index">Air Quality Index</div>
                                    </div>
                                    <div class="metric air">
                                        <div class="metric-value" id="air-co2">415 ppm</div>
                                        <div class="metric-label" data-i18n="co2_level">CO2 Level</div>
                                    </div>
                                    <div class="metric air">
                                        <div class="metric-value" id="air-humidity">65%</div>
                                        <div class="metric-label" data-i18n="humidity">Humidity</div>
                                    </div>
                                    <div class="metric air">
                                        <div class="metric-value" id="air-temperature">24C</div>
                                        <div class="metric-label" data-i18n="temperature">Temperature</div>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="windChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Satellite Tab -->
                        <div id="satellite-tab" class="tab-content">
                            <div class="analysis-card">
                                <div class="card-header">
                                    <h2 class="card-title">
                                        <span data-i18n="satellite_data_analysis">Satellite Data Analysis</span> 
                                        <span class="nasa-badge" data-i18n="live_feed">LIVE FEED</span>
                                    </h2>
                                    <div class="card-status status-good" data-i18n="active">Active</div>
                                </div>
                                <div class="metrics-grid">
                                    <div class="metric soil">
                                        <div class="metric-value" id="satellite-ndvi">0.72</div>
                                        <div class="metric-label" data-i18n="ndvi_index">NDVI Index</div>
                                    </div>
                                    <div class="metric water">
                                        <div class="metric-value" id="satellite-moisture">0.38</div>
                                        <div class="metric-label" data-i18n="soil_moisture">Soil Moisture</div>
                                    </div>
                                    <div class="metric air">
                                        <div class="metric-value" id="satellite-temp">24C</div>
                                        <div class="metric-label" data-i18n="surface_temp">Surface Temp</div>
                                    </div>
                                    <div class="metric soil">
                                        <div class="metric-value" id="satellite-health">88%</div>
                                        <div class="metric-label" data-i18n="vegetation_health">Vegetation Health</div>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="satelliteChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Recommendations Page -->
                <section id="recommendations" class="page">
                    <div class="container">
                        <div class="dashboard-header">
                            <h1 class="dashboard-title">
                                <span data-i18n="crop_recommendations">Crop Recommendations</span> 
                                <span class="nasa-badge" data-i18n="nasa_enhanced">NASA ENHANCED</span>
                            </h1>
                            <p data-i18n="recommendations_description">Best crops for your farm based on current conditions and NASA satellite data</p>
                        </div>
                        
                        <div class="carousel-container">
                            <div class="carousel" id="carousel">
                                <!-- Carousel items will be populated dynamically -->
                            </div>
                            <button class="carousel-nav carousel-prev" id="carousel-prev">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="carousel-nav carousel-next" id="carousel-next">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <div class="carousel-controls" id="carousel-controls">
                                <!-- Carousel controls will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- CropLens AI Page -->
                <section id="crop-lens" class="page">
                    <div class="container">
                        <div class="dashboard-header">
                            <h1 class="dashboard-title">
                                <span data-i18n="crop_lens">CropLens AI Assistant</span> 
                                <span class="nasa-badge" data-i18n="nasa_powered">NASA POWERED</span>
                            </h1>
                            <p data-i18n="crop_lens_description">Get AI-powered insights for your farming decisions enhanced with NASA satellite data</p>
                        </div>
                        
                        <div class="ai-assistant-card">
                            <div class="ai-header">
                                <div class="ai-icon">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div>
                                    <h2 class="ai-title" data-i18n="crop_lens">CropLens AI</h2>
                                    <p data-i18n="crop_lens_intro">Ask questions about soil conditions, crop recommendations, pest control, and more. Our AI assistant uses real-time NASA satellite data for precise insights.</p>
                                </div>
                            </div>
                            
                            <div class="chat-container">
                                <div class="chat-messages" id="chat-messages">
                                    <div class="message ai-message" data-i18n="ai_welcome">
                                        Hello! I'm CropLens AI, your agricultural assistant powered by NASA satellite data. I can help you with soil analysis, crop recommendations, pest control, and more using real-time satellite insights. How can I assist you today?
                                    </div>
                                </div>
                                <div class="chat-input-container">
                                    <input type="text" class="chat-input" id="chat-input" data-i18n-placeholder="ai_placeholder" placeholder="Ask a question about farming...">
                                    <button class="send-btn" id="send-btn">
                                        <i class="fas fa-paper-plane"></i> <span data-i18n="send">Send</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Market Trends Page -->
                <section id="market-trends" class="page">
                    <div class="container">
                        <div class="market-trends-header">
                            <h1 class="market-trends-title">
                                <span data-i18n="market_trends">Agricultural Market Trends</span> 
                                <span class="nasa-badge" data-i18n="real_time_data">REAL-TIME DATA</span>
                            </h1>
                            <p data-i18n="market_trends_description">Track current market prices and trends for agricultural products</p>
                        </div>
                        
                        <div class="price-cards" id="price-cards">
                            <!-- Price cards will be populated dynamically -->
                        </div>
                        
                        <div class="timeframe-selector">
                            <button class="timeframe-btn active" data-timeframe="1M" data-i18n="1_month">1 Month</button>
                            <button class="timeframe-btn" data-timeframe="3M" data-i18n="3_months">3 Months</button>
                            <button class="timeframe-btn" data-timeframe="6M" data-i18n="6_months">6 Months</button>
                            <button class="timeframe-btn" data-timeframe="1Y" data-i18n="1_year">1 Year</button>
                        </div>
                        
                        <div class="market-charts">
                            <div class="chart-card">
                                <div class="chart-card-header">
                                    <h2 class="chart-card-title">
                                        <i class="fas fa-chart-line"></i> <span data-i18n="price_trends">Price Trends</span> - <span id="selected-vegetable">Tomatoes</span>
                                    </h2>
                                </div>
                                <div class="chart-card-container">
                                    <canvas id="priceTrendChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="chart-card">
                                <div class="chart-card-header">
                                    <h2 class="chart-card-title">
                                        <i class="fas fa-percentage"></i> <span data-i18n="market_share">Market Share</span>
                                    </h2>
                                </div>
                                <div class="chart-card-container">
                                    <canvas id="marketShareChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- NEW: Account Page -->
                <section id="account" class="page">
                    <div class="container">
                        <div class="dashboard-header">
                            <h1 class="dashboard-title">
                                <span data-i18n="account">Account Information</span>
                                <span class="nasa-badge" data-i18n="user_profile">USER PROFILE</span>
                            </h1>
                            <p data-i18n="account_description">Manage your account details and preferences</p>
                        </div>
                        
                        <div class="account-card">
                            <div class="account-header">
                                <div class="account-avatar" id="account-avatar">U</div>
                                <div class="account-info">
                                    <h2 class="account-name" id="account-name">User</h2>
                                    <p data-i18n="premium_user">Premium User</p>
                                </div>
                            </div>
                            
                            <div class="account-details">
                                <div class="account-field">
                                    <span class="account-label" data-i18n="username">Username:</span>
                                    <span class="account-value" id="account-username">user123</span>
                                </div>
                                
                                <div class="account-field">
                                    <span class="account-label" data-i18n="password">Password:</span>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <span class="account-value" id="account-password"></span>
                                        <button class="toggle-password" id="toggle-account-password">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="account-field">
                                    <span class="account-label" data-i18n="login_date">Last Login:</span>
                                    <span class="account-value" id="account-login-date">Loading...</span>
                                </div>
                                
                                <div class="account-field">
                                    <span class="account-label" data-i18n="account_created">Account Created:</span>
                                    <span class="account-value" id="account-created-date">Loading...</span>
                                </div>
                                
                                <div class="account-field">
                                    <span class="account-label" data-i18n="language">Language:</span>
                                    <span class="account-value" id="account-language">English</span>
                                </div>
                            </div>
                            
                            <button class="logout-btn" id="account-logout-btn">
                                <i class="fas fa-sign-out-alt"></i> <span data-i18n="logout">Logout</span>
                            </button>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        // Translation system
        const translations = {
        pa: {  
            sign_in: "  ",
            logout: " ",
            dashboard: "",
            username_label: " ",
            password_label: "",
            confirm_password: "  ",
            create_account: " ",
            farm_analysis: "  ",
            market_trends: " ",
        },
            en: {
                // Login page
                "app_title": "SoilScope",
                "app_subtitle": "NASA-Powered Agricultural Intelligence",
                "nasa_connected": "NASA API Connected",
                "username_label": "Username",
                "username_placeholder": "Enter your username",
                "password_label": "Password",
                "password_placeholder": "Enter your password",
                "sign_in": "Sign In",
                "no_account": "Don't have an account?",
                "contact_admin": "Contact Administrator",
                "create_account": "Create Account",
                "confirm_password": "Confirm Password",
                "create_account_link": "Create Account",
                "already_account": "Already have an account?",
                
                // Main app
                "dashboard": "Dashboard",
                "analysis": "Analysis",
                "recommendations": "Recommendations",
                "crop_lens": "CropLens AI",
                "market_trends": "Market Trends",
                "account": "Account",
                "nasa_powered": "NASA POWERED",
                "nasa_online": "NASA ONLINE",
                "level": "Level 5",
                "logout": "Logout",
                
                // Dashboard
                "farm_analysis": "Farm Analysis Dashboard",
                "nasa_satellite": "NASA SATELLITE DATA",
                "dashboard_description": "Monitor your soil, water, and air conditions with real-time NASA satellite data",
                "soil_health": "Soil Health",
                "water_quality": "Water Quality",
                "air_quality": "Air Quality",
                "optimal_conditions": "Optimal Conditions",
                "good_level": "Good Level",
                "excellent": "Excellent",
                "farm_location": "Farm Location & Analysis",
                "live_satellite": "LIVE SATELLITE",
                "search": "Search",
                "my_location": "My Location",
                "fetch_nasa": "Fetch NASA Data",
                "save_location": "Save Location",
                "current_location": "Current Location",
                "live": "LIVE",
                "latitude": "Latitude:",
                "longitude": "Longitude:",
                "address": "Address:",
                "ndvi_index": "NDVI Index:",
                "soil_moisture": "Soil Moisture:",
                "detailed_analysis": "Detailed Analysis",
                
                // Analysis
                "detailed_analysis": "Detailed Analysis",
                "nasa_data": "NASA DATA",
                "analysis_description": "Comprehensive breakdown of soil, water, and air conditions using NASA satellite data",
                "analyzing_data": "Analyzing data for your selected location",
                "soil_analysis": "Soil Analysis",
                "water_analysis": "Water Analysis",
                "air_analysis": "Air Analysis",
                "satellite_data": "Satellite Data",
                "soil_health_overview": "Soil Health Overview",
                "optimal": "Optimal",
                "acidity_level": "Acidity Level",
                "moisture_content": "Moisture Content",
                "organic_matter": "Organic Matter",
                "nutrient_level": "Nutrient Level",
                "water_quality_overview": "Water Quality Overview",
                "good": "Good",
                "water_acidity": "Water Acidity",
                "dissolved_solids": "Total Dissolved Solids",
                "nitrate_level": "Nitrate Level",
                "bacterial_quality": "Bacterial Quality",
                "air_quality_overview": "Air Quality Overview",
                "air_quality_index": "Air Quality Index",
                "co2_level": "CO2 Level",
                "humidity": "Humidity",
                "temperature": "Temperature",
                "satellite_data_analysis": "Satellite Data Analysis",
                "live_feed": "LIVE FEED",
                "active": "Active",
                "surface_temp": "Surface Temp",
                "vegetation_health": "Vegetation Health",
                
                // Recommendations
                "crop_recommendations": "Crop Recommendations",
                "nasa_enhanced": "NASA ENHANCED",
                "recommendations_description": "Best crops for your farm based on current conditions and NASA satellite data",
                
                // CropLens AI
                "crop_lens_description": "Get AI-powered insights for your farming decisions enhanced with NASA satellite data",
                "crop_lens_intro": "Ask questions about soil conditions, crop recommendations, pest control, and more. Our AI assistant uses real-time NASA satellite data for precise insights.",
                "ai_welcome": "Hello! I'm CropLens AI, your agricultural assistant powered by NASA satellite data. I can help you with soil analysis, crop recommendations, pest control, and more using real-time satellite insights. How can I assist you today?",
                "ai_placeholder": "Ask a question about farming...",
                "send": "Send",
                
                // Market Trends
                "market_trends": "Agricultural Market Trends",
                "real_time_data": "REAL-TIME DATA",
                "market_trends_description": "Track current market prices and trends for agricultural products",
                "1_month": "1 Month",
                "3_months": "3 Months",
                "6_months": "6 Months",
                "1_year": "1 Year",
                "price_trends": "Price Trends",
                "market_share": "Market Share",
                
                // Account
                "user_profile": "USER PROFILE",
                "account_description": "Manage your account details and preferences",
                "premium_user": "Premium User",
                "username": "Username:",
                "password": "Password:",
                "login_date": "Last Login:",
                "account_created": "Account Created:",
                "language": "Language:"
            },
            es: {
                // Login page
                "app_title": "SoilScope",
                "app_subtitle": "Inteligencia Agrcola con Tecnologa NASA",
                "nasa_connected": "API de NASA Conectada",
                "username_label": "Nombre de usuario",
                "username_placeholder": "Ingresa tu nombre de usuario",
                "password_label": "Contrasea",
                "password_placeholder": "Ingresa tu contrasea",
                "sign_in": "Iniciar Sesin",
                "no_account": "No tienes una cuenta?",
                "contact_admin": "Contactar Administrador",
                "create_account": "Crear Cuenta",
                "confirm_password": "Confirmar Contrasea",
                "create_account_link": "Crear Cuenta",
                "already_account": "Ya tienes una cuenta?",
                
                // Main app
                "dashboard": "Panel",
                "analysis": "Anlisis",
                "recommendations": "Recomendaciones",
                "crop_lens": "CropLens AI",
                "market_trends": "Tendencias del Mercado",
                "account": "Cuenta",
                "nasa_powered": "CON TECNOLOGA NASA",
                "nasa_online": "NASA EN LNEA",
                "level": "Nivel 5",
                "logout": "Cerrar Sesin",
                
                // Dashboard
                "farm_analysis": "Panel de Anlisis Agrcola",
                "nasa_satellite": "DATOS DE SATLITE NASA",
                "dashboard_description": "Monitorea las condiciones de suelo, agua y aire con datos de satlite NASA en tiempo real",
                "soil_health": "Salud del Suelo",
                "water_quality": "Calidad del Agua",
                "air_quality": "Calidad del Aire",
                "optimal_conditions": "Condiciones ptimas",
                "good_level": "Nivel Bueno",
                "excellent": "Excelente",
                "farm_location": "Ubicacin y Anlisis de la Granja",
                "live_satellite": "SATLITE EN VIVO",
                "search": "Buscar",
                "my_location": "Mi Ubicacin",
                "fetch_nasa": "Obtener Datos NASA",
                "save_location": "Guardar Ubicacin",
                "current_location": "Ubicacin Actual",
                "live": "EN VIVO",
                "latitude": "Latitud:",
                "longitude": "Longitud:",
                "address": "Direccin:",
                "ndvi_index": "ndice NDVI:",
                "soil_moisture": "Humedad del Suelo:",
                "detailed_analysis": "Anlisis Detallado",
                
                // Analysis
                "detailed_analysis": "Anlisis Detallado",
                "nasa_data": "DATOS NASA",
                "analysis_description": "Desglose completo de las condiciones de suelo, agua y aire usando datos de satlite NASA",
                "analyzing_data": "Analizando datos para tu ubicacin seleccionada",
                "soil_analysis": "Anlisis de Suelo",
                "water_analysis": "Anlisis de Agua",
                "air_analysis": "Anlisis de Aire",
                "satellite_data": "Datos Satelitales",
                "soil_health_overview": "Resumen de Salud del Suelo",
                "optimal": "ptimo",
                "acidity_level": "Nivel de Acidez",
                "moisture_content": "Contenido de Humedad",
                "organic_matter": "Materia Orgnica",
                "nutrient_level": "Nivel de Nutrientes",
                "water_quality_overview": "Resumen de Calidad del Agua",
                "good": "Bueno",
                "water_acidity": "Acidez del Agua",
                "dissolved_solids": "Slidos Disueltos Totales",
                "nitrate_level": "Nivel de Nitratos",
                "bacterial_quality": "Calidad Bacteriana",
                "air_quality_overview": "Resumen de Calidad del Aire",
                "air_quality_index": "ndice de Calidad del Aire",
                "co2_level": "Nivel de CO2",
                "humidity": "Humedad",
                "temperature": "Temperatura",
                "satellite_data_analysis": "Anlisis de Datos Satelitales",
                "live_feed": "TRANSMISIN EN VIVO",
                "active": "Activo",
                "surface_temp": "Temp. Superficial",
                "vegetation_health": "Salud de la Vegetacin",
                
                // Recommendations
                "crop_recommendations": "Recomendaciones de Cultivos",
                "nasa_enhanced": "MEJORADO POR NASA",
                "recommendations_description": "Mejores cultivos para tu granja basados en condiciones actuales y datos de satlite NASA",
                
                // CropLens AI
                "crop_lens_description": "Obtn informacin con IA para tus decisiones agrcolas mejoradas con datos de satlite NASA",
                "crop_lens_intro": "Haz preguntas sobre condiciones del suelo, recomendaciones de cultivos, control de plagas y ms. Nuestro asistente de IA utiliza datos de satlite NASA en tiempo real para insights precisos.",
                "ai_welcome": "Hola! Soy CropLens AI, tu asistente agrcola con tecnologa de datos de satlite NASA. Puedo ayudarte con anlisis de suelo, recomendaciones de cultivos, control de plagas y ms usando informacin satelital en tiempo real. Cmo puedo ayudarte hoy?",
                "ai_placeholder": "Haz una pregunta sobre agricultura...",
                "send": "Enviar",
                
                // Market Trends
                "market_trends": "Tendencias del Mercado Agrcola",
                "real_time_data": "DATOS EN TIEMPO REAL",
                "market_trends_description": "Sigue los precios actuales del mercado y tendencias para productos agrcolas",
                "1_month": "1 Mes",
                "3_months": "3 Meses",
                "6_months": "6 Meses",
                "1_year": "1 Ao",
                "price_trends": "Tendencias de Precios",
                "market_share": "Cuota de Mercado",
                
                // Account
                "user_profile": "PERFIL DE USUARIO",
                "account_description": "Administra los detalles y preferencias de tu cuenta",
                "premium_user": "Usuario Premium",
                "username": "Nombre de usuario:",
                "password": "Contrasea:",
                "login_date": "ltimo Inicio:",
                "account_created": "Cuenta Creada:",
                "language": "Idioma:"
            },
            fr: {
                // Login page
                "app_title": "SoilScope",
                "app_subtitle": "Intelligence Agricole Propulse par la NASA",
                "nasa_connected": "API NASA Connecte",
                "username_label": "Nom d'utilisateur",
                "username_placeholder": "Entrez votre nom d'utilisateur",
                "password_label": "Mot de passe",
                "password_placeholder": "Entrez votre mot de passe",
                "sign_in": "Se Connecter",
                "no_account": "Vous n'avez pas de compte ?",
                "contact_admin": "Contacter l'Administrateur",
                "create_account": "Crer un Compte",
                "confirm_password": "Confirmer le Mot de Passe",
                "create_account_link": "Crer un Compte",
                "already_account": "Vous avez dj un compte ?",
                
                // Main app
                "dashboard": "Tableau de Bord",
                "analysis": "Analyse",
                "recommendations": "Recommandations",
                "crop_lens": "CropLens IA",
                "market_trends": "Tendances du March",
                "account": "Compte",
                "nasa_powered": "PROPULS PAR LA NASA",
                "nasa_online": "NASA EN LIGNE",
                "level": "Niveau 5",
                "logout": "Dconnexion",
                
                // Dashboard
                "farm_analysis": "Tableau de Bord d'Analyse Agricole",
                "nasa_satellite": "DONNES SATELLITE NASA",
                "dashboard_description": "Surveillez les conditions de sol, d'eau et d'air avec des donnes satellite NASA en temps rel",
                "soil_health": "Sant du Sol",
                "water_quality": "Qualit de l'Eau",
                "air_quality": "Qualit de l'Air",
                "optimal_conditions": "Conditions Optimales",
                "good_level": "Bon Niveau",
                "excellent": "Excellent",
                "farm_location": "Localisation et Analyse de la Ferme",
                "live_satellite": "SATELLITE EN DIRECT",
                "search": "Rechercher",
                "my_location": "Ma Position",
                "fetch_nasa": "Rcuprer Donnes NASA",
                "save_location": "Sauvegarder Position",
                "current_location": "Position Actuelle",
                "live": "EN DIRECT",
                "latitude": "Latitude :",
                "longitude": "Longitude :",
                "address": "Adresse :",
                "ndvi_index": "Indice NDVI :",
                "soil_moisture": "Humidit du Sol :",
                "detailed_analysis": "Analyse Dtaille",
                
                // Analysis
                "detailed_analysis": "Analyse Dtaille",
                "nasa_data": "DONNES NASA",
                "analysis_description": "Analyse complte des conditions de sol, d'eau et d'air utilisant des donnes satellite NASA",
                "analyzing_data": "Analyse des donnes pour votre position slectionne",
                "soil_analysis": "Analyse du Sol",
                "water_analysis": "Analyse de l'Eau",
                "air_analysis": "Analyse de l'Air",
                "satellite_data": "Donnes Satellites",
                "soil_health_overview": "Aperu de la Sant du Sol",
                "optimal": "Optimal",
                "acidity_level": "Niveau d'Acidit",
                "moisture_content": "Teneur en Humidit",
                "organic_matter": "Matire Organique",
                "nutrient_level": "Niveau de Nutriments",
                "water_quality_overview": "Aperu de la Qualit de l'Eau",
                "good": "Bon",
                "water_acidity": "Acidit de l'Eau",
                "dissolved_solids": "Solides Dissous Totaux",
                "nitrate_level": "Niveau de Nitrates",
                "bacterial_quality": "Qualit Bactrienne",
                "air_quality_overview": "Aperu de la Qualit de l'Air",
                "air_quality_index": "Indice de Qualit de l'Air",
                "co2_level": "Niveau de CO2",
                "humidity": "Humidit",
                "temperature": "Temprature",
                "satellite_data_analysis": "Analyse des Donnes Satellites",
                "live_feed": "FLUX EN DIRECT",
                "active": "Actif",
                "surface_temp": "Temp. Surface",
                "vegetation_health": "Sant de la Vgtation",
                
                // Recommendations
                "crop_recommendations": "Recommandations de Cultures",
                "nasa_enhanced": "AMLIOR PAR LA NASA",
                "recommendations_description": "Meilleures cultures pour votre ferme bases sur les conditions actuelles et les donnes satellite NASA",
                
                // CropLens AI
                "crop_lens_description": "Obtenez des insights IA pour vos dcisions agricoles amliores avec des donnes satellite NASA",
                "crop_lens_intro": "Posez des questions sur les conditions du sol, les recommandations de cultures, le contrle des parasites et plus. Notre assistant IA utilise des donnes satellite NASA en temps rel pour des insights prcis.",
                "ai_welcome": "Bonjour ! Je suis CropLens IA, votre assistant agricole propuls par les donnes satellite NASA. Je peux vous aider avec l'analyse du sol, les recommandations de cultures, le contrle des parasites et plus en utilisant les insights satellitaires en temps rel. Comment puis-je vous aider aujourd'hui ?",
                "ai_placeholder": "Posez une question sur l'agriculture...",
                "send": "Envoyer",
                
                // Market Trends
                "market_trends": "Tendances du March Agricole",
                "real_time_data": "DONNES EN TEMPS REL",
                "market_trends_description": "Suivez les prix actuels du march et les tendances pour les produits agricoles",
                "1_month": "1 Mois",
                "3_months": "3 Mois",
                "6_months": "6 Mois",
                "1_year": "1 An",
                "price_trends": "Tendances des Prix",
                "market_share": "Part de March",
                
                // Account
                "user_profile": "PROFIL UTILISATEUR",
                "account_description": "Grez vos dtails de compte et prfrences",
                "premium_user": "Utilisateur Premium",
                "username": "Nom d'utilisateur:",
                "password": "Mot de passe:",
                "login_date": "Dernire Connexion:",
                "account_created": "Compte Cr:",
                "language": "Langue:"
            },
            hi: {
                // Login page
                "app_title": "SoilScope",
                "app_subtitle": "-  ",
                "nasa_connected": " API ",
                "username_label": " ",
                "username_placeholder": "    ",
                "password_label": "",
                "password_placeholder": "   ",
                "sign_in": "  ",
                "no_account": "  ?",
                "contact_admin": "   ",
                "create_account": " ",
                "confirm_password": "   ",
                "create_account_link": " ",
                "already_account": "     ?",
                
                // Main app
                "dashboard": "",
                "analysis": "",
                "recommendations": "",
                "crop_lens": " AI",
                "market_trends": " ",
                "account": "",
                "nasa_powered": " ",
                "nasa_online": " ",
                "level": " 5",
                "logout": "",
                
                // Dashboard
                "farm_analysis": "  ",
                "nasa_satellite": "  ",
                "dashboard_description": "     ,        ",
                "soil_health": " ",
                "water_quality": " ",
                "air_quality": " ",
                "optimal_conditions": " ",
                "good_level": " ",
                "excellent": "",
                "farm_location": "   ",
                "live_satellite": " ",
                "search": "",
                "my_location": " ",
                "fetch_nasa": "   ",
                "save_location": " ",
                "current_location": " ",
                "live": "",
                "latitude": ":",
                "longitude": ":",
                "address": ":",
                "ndvi_index": "NDVI :",
                "soil_moisture": " :",
                "detailed_analysis": " ",
                
                // Analysis
                "detailed_analysis": " ",
                "nasa_data": " ",
                "analysis_description": "      ,        ",
                "analyzing_data": "          ",
                "soil_analysis": " ",
                "water_analysis": " ",
                "air_analysis": " ",
                "satellite_data": " ",
                "soil_health_overview": "  ",
                "optimal": "",
                "acidity_level": " ",
                "moisture_content": " ",
                "organic_matter": " ",
                "nutrient_level": "  ",
                "water_quality_overview": "  ",
                "good": "",
                "water_acidity": " ",
                "dissolved_solids": "   ",
                "nitrate_level": " ",
                "bacterial_quality": " ",
                "air_quality_overview": "  ",
                "air_quality_index": "  ",
                "co2_level": "CO2 ",
                "humidity": "",
                "temperature": "",
                "satellite_data_analysis": "  ",
                "live_feed": " ",
                "active": "",
                "surface_temp": " ",
                "vegetation_health": " ",
                
                // Recommendations
                "crop_recommendations": " ",
                "nasa_enhanced": " ",
                "recommendations_description": "              ",
                
                // CropLens AI
                "crop_lens_description": "          AI-   ",
                "crop_lens_intro": "  ,  ,           AI      -       ",
                "ai_welcome": "!   AI ,              ,  ,      -                 ?",
                "ai_placeholder": "     ...",
                "send": "",
                
                // Market Trends
                "market_trends": "  ",
                "real_time_data": "- ",
                "market_trends_description": "           ",
                "1_month": "1 ",
                "3_months": "3 ",
                "6_months": "6 ",
                "1_year": "1 ",
                "price_trends": " ",
                "market_share": " ",
                
                // Account
                "user_profile": " ",
                "account_description": "       ",
                "premium_user": " ",
                "username": " :",
                "password": ":",
                "login_date": " :",
                "account_created": "  :",
                "language": ":"
            }
        };

        let currentLanguage = 'en';

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            
            // Update language buttons
            document.querySelectorAll('.language-btn span').forEach(span => {
                span.textContent = translations[lang]['app_title'] || 'SoilScope';
            });
            
            // Update sidebar language text
            document.getElementById('sidebar-language-text').textContent = translations[lang]['app_title'] || 'SoilScope';
            
            // Update active language in dropdown
            document.querySelectorAll('.language-option').forEach(option => {
                if (option.getAttribute('data-lang') === lang) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // Update all translatable elements
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            
            // Update all translatable placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) {
                    element.setAttribute('placeholder', translations[lang][key]);
                }
            });
            
            // Update form toggle text
            const loginForm = document.getElementById('login-form');
            const formToggleText = document.getElementById('form-toggle-text');
            
            if (loginForm.style.display !== 'none') {
                formToggleText.innerHTML = translations[lang]['no_account'] + ' <a href="#" id="form-toggle-link">' + translations[lang]['create_account_link'] + '</a>';
            } else {
                formToggleText.innerHTML = translations[lang]['already_account'] + ' <a href="#" id="form-toggle-link">' + translations[lang]['sign_in'] + '</a>';
            }
            
            // Update account language
            document.getElementById('account-language').textContent = getLanguageName(lang);
            
            // Close dropdowns
            document.querySelectorAll('.language-dropdown').forEach(dropdown => {
                dropdown.classList.remove('show');
            });
            document.querySelectorAll('.sidebar-language-dropdown').forEach(dropdown => {
                dropdown.classList.remove('show');
            });
            
            showToast(`Language changed to ${getLanguageName(lang)}`);
        }

        function getLanguageName(lang) {
            const names = {
                'en': 'English',
                'es': 'Spanish',
                'fr': 'French',
                'hi': 'Hindi'
            };
            return names[lang] || 'Unknown';
        }

        function setupLanguageSelector() {
            // Set initial language
            const savedLanguage = localStorage.getItem('language') || 'en';
            changeLanguage(savedLanguage);
            
            // Setup language selector buttons
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const dropdown = this.nextElementSibling;
                    dropdown.classList.toggle('show');
                });
            });
            
            // Setup sidebar language selector
            document.getElementById('sidebar-language-btn').addEventListener('click', function() {
                const dropdown = document.getElementById('sidebar-language-dropdown');
                dropdown.classList.toggle('show');
            });
            
            // Setup language options
            document.querySelectorAll('.language-option').forEach(option => {
                option.addEventListener('click', function() {
                    const lang = this.getAttribute('data-lang');
                    changeLanguage(lang);
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.language-selector') && !e.target.closest('.sidebar-language-selector')) {
                    document.querySelectorAll('.language-dropdown').forEach(dropdown => {
                        dropdown.classList.remove('show');
                    });
                    document.querySelectorAll('.sidebar-language-dropdown').forEach(dropdown => {
                        dropdown.classList.remove('show');
                    });
                }
            });
        }

        // Original application code remains the same from here...
        // (All the existing classes and functions)

        // CityBasedAgriculturalData class
        class CityBasedAgriculturalData {
            constructor() {
                this.cityDatabase = this.initializeCityDatabase();
                this.cropRecommender = new AdvancedCropRecommender();
            }

            initializeCityDatabase() {
                return {
                    // Indian Cities
                    'Amritsar': { 
                        lat: 31.6340, lng: 74.8723, 
                        climate: 'fertile_plains',
                        soil: { phRange: [6.2, 7.5], organicRange: [2.5, 4.5], moistureRange: [35, 60] },
                        water: { phRange: [6.8, 7.4], tdsRange: [150, 400], nitrateRange: [0.3, 0.9] },
                        air: { aqiRange: [80, 180], co2Range: [410, 430], tempRange: [5, 42] },
                        ndviRange: [0.65, 0.85],
                        primaryCrops: ['Wheat', 'Rice', 'Maize', 'Sugarcane']
                    },
                    'Ludhiana': { 
                        lat: 30.9010, lng: 75.8573, 
                        climate: 'fertile_plains',
                        soil: { phRange: [6.5, 7.8], organicRange: [2.0, 4.0], moistureRange: [30, 55] },
                        water: { phRange: [7.0, 7.6], tdsRange: [200, 500], nitrateRange: [0.4, 1.2] },
                        air: { aqiRange: [90, 200], co2Range: [415, 435], tempRange: [7, 45] },
                        ndviRange: [0.60, 0.80],
                        primaryCrops: ['Wheat', 'Rice', 'Cotton', 'Vegetables']
                    },
                    'Chandigarh': { 
                        lat: 30.7333, lng: 76.7794, 
                        climate: 'sub_tropical',
                        soil: { phRange: [6.0, 7.2], organicRange: [2.2, 4.2], moistureRange: [25, 50] },
                        water: { phRange: [6.9, 7.5], tdsRange: [180, 450], nitrateRange: [0.3, 0.8] },
                        air: { aqiRange: [70, 160], co2Range: [405, 425], tempRange: [4, 40] },
                        ndviRange: [0.55, 0.75],
                        primaryCrops: ['Wheat', 'Rice', 'Maize', 'Fruits']
                    },
                    'Jalandhar': { 
                        lat: 31.3260, lng: 75.5762, 
                        climate: 'fertile_plains',
                        soil: { phRange: [6.3, 7.6], organicRange: [2.3, 4.3], moistureRange: [32, 58] },
                        water: { phRange: [6.8, 7.4], tdsRange: [170, 420], nitrateRange: [0.3, 1.0] },
                        air: { aqiRange: [85, 190], co2Range: [412, 432], tempRange: [6, 43] },
                        ndviRange: [0.62, 0.82],
                        primaryCrops: ['Wheat', 'Rice', 'Sugarcane', 'Vegetables']
                    },

                    // Saudi Arabia
                    'Riyadh': { 
                        lat: 24.7136, lng: 46.6753, 
                        climate: 'arid_desert',
                        soil: { phRange: [7.5, 8.5], organicRange: [0.5, 1.5], moistureRange: [2, 15] },
                        water: { phRange: [7.8, 8.6], tdsRange: [800, 2000], nitrateRange: [0.8, 2.5] },
                        air: { aqiRange: [120, 250], co2Range: [420, 450], tempRange: [10, 48] },
                        ndviRange: [0.10, 0.30],
                        primaryCrops: ['Dates', 'Alfalfa', 'Barley', 'Wheat']
                    },
                    'Jeddah': { 
                        lat: 21.4858, lng: 39.1925, 
                        climate: 'coastal_arid',
                        soil: { phRange: [7.2, 8.2], organicRange: [0.8, 2.0], moistureRange: [5, 20] },
                        water: { phRange: [7.5, 8.3], tdsRange: [600, 1500], nitrateRange: [0.6, 2.0] },
                        air: { aqiRange: [100, 220], co2Range: [415, 445], tempRange: [18, 42] },
                        ndviRange: [0.15, 0.35],
                        primaryCrops: ['Dates', 'Vegetables', 'Fruits', 'Cereals']
                    },

                    // USA
                    'Los Angeles': { 
                        lat: 34.0522, lng: -118.2437, 
                        climate: 'mediterranean',
                        soil: { phRange: [6.0, 7.5], organicRange: [1.5, 3.5], moistureRange: [15, 35] },
                        water: { phRange: [7.0, 8.0], tdsRange: [300, 700], nitrateRange: [0.4, 1.5] },
                        air: { aqiRange: [50, 150], co2Range: [410, 430], tempRange: [10, 35] },
                        ndviRange: [0.40, 0.65],
                        primaryCrops: ['Citrus', 'Avocado', 'Grapes', 'Nuts']
                    },
                    'Miami': { 
                        lat: 25.7617, lng: -80.1918, 
                        climate: 'tropical',
                        soil: { phRange: [5.5, 7.0], organicRange: [3.0, 6.0], moistureRange: [40, 70] },
                        water: { phRange: [6.5, 7.5], tdsRange: [200, 500], nitrateRange: [0.2, 0.8] },
                        air: { aqiRange: [40, 120], co2Range: [405, 425], tempRange: [20, 35] },
                        ndviRange: [0.70, 0.90],
                        primaryCrops: ['Citrus', 'Tropical Fruits', 'Vegetables', 'Sugarcane']
                    },

                    // Europe
                    'Paris': { 
                        lat: 48.8566, lng: 2.3522, 
                        climate: 'temperate',
                        soil: { phRange: [6.0, 7.2], organicRange: [2.5, 5.0], moistureRange: [25, 50] },
                        water: { phRange: [6.8, 7.4], tdsRange: [150, 400], nitrateRange: [0.3, 1.0] },
                        air: { aqiRange: [30, 100], co2Range: [400, 420], tempRange: [0, 25] },
                        ndviRange: [0.55, 0.75],
                        primaryCrops: ['Wheat', 'Barley', 'Corn', 'Grapes']
                    },
                    'Rome': { 
                        lat: 41.9028, lng: 12.4964, 
                        climate: 'mediterranean',
                        soil: { phRange: [6.2, 7.8], organicRange: [2.0, 4.0], moistureRange: [20, 45] },
                        water: { phRange: [7.2, 8.0], tdsRange: [250, 600], nitrateRange: [0.4, 1.2] },
                        air: { aqiRange: [40, 120], co2Range: [405, 425], tempRange: [5, 30] },
                        ndviRange: [0.50, 0.70],
                        primaryCrops: ['Grapes', 'Olives', 'Wheat', 'Vegetables']
                    },

                    // Default
                    'default': { 
                        lat: 0, lng: 0, 
                        climate: 'temperate',
                        soil: { phRange: [6.0, 7.5], organicRange: [2.0, 4.0], moistureRange: [25, 50] },
                        water: { phRange: [6.8, 7.5], tdsRange: [200, 500], nitrateRange: [0.3, 1.0] },
                        air: { aqiRange: [50, 150], co2Range: [400, 430], tempRange: [10, 30] },
                        ndviRange: [0.50, 0.75],
                        primaryCrops: ['Wheat', 'Corn', 'Vegetables', 'Fruits']
                    }
                };
            }

            findClosestCity(lat, lng, address = '') {
                // First try to match by address
                if (address) {
                    const addressLower = address.toLowerCase();
                    for (const cityName in this.cityDatabase) {
                        if (cityName !== 'default' && addressLower.includes(cityName.toLowerCase())) {
                            return { city: this.cityDatabase[cityName], name: cityName };
                        }
                    }
                }

                // If no match by address, find by distance
                let closestCity = { city: this.cityDatabase.default, name: 'default', distance: Infinity };
                
                for (const cityName in this.cityDatabase) {
                    if (cityName === 'default') continue;
                    
                    const city = this.cityDatabase[cityName];
                    const distance = this.calculateDistance(lat, lng, city.lat, city.lng);
                    
                    if (distance < closestCity.distance) {
                        closestCity = { city, name: cityName, distance };
                    }
                }
                
                // Return closest city if within 200km, otherwise default
                return closestCity.distance < 200 ? closestCity : { city: this.cityDatabase.default, name: 'Unknown Location' };
            }

            calculateDistance(lat1, lng1, lat2, lng2) {
                const R = 6371; // Earth's radius in km
                const dLat = (lat2 - lat1) * Math.PI / 180;
                const dLng = (lng2 - lng1) * Math.PI / 180;
                const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                          Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                          Math.sin(dLng/2) * Math.sin(dLng/2);
                const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                return R * c;
            }

            calculateRealisticTemperature(cityData, month = new Date().getMonth()) {
                // Base temperature ranges for different climates
                const baseTemps = {
                    'fertile_plains': [8, 42], // Punjab region
                    'sub_tropical': [5, 40],   // Chandigarh
                    'arid_desert': [10, 48],   // Riyadh
                    'coastal_arid': [18, 42],  // Jeddah
                    'mediterranean': [10, 35], // Los Angeles, Rome
                    'tropical': [20, 35],      // Miami
                    'temperate': [0, 25]       // Paris
                };
                
                const [minTemp, maxTemp] = baseTemps[cityData.climate] || [10, 30];
                
                // Adjust temperature based on season (month)
                let currentTemp;
                if (month >= 3 && month <= 5) { // Spring
                    currentTemp = minTemp + (maxTemp - minTemp) * 0.4;
                } else if (month >= 6 && month <= 8) { // Summer
                    currentTemp = minTemp + (maxTemp - minTemp) * 0.8;
                } else if (month >= 9 && month <= 10) { // Fall
                    currentTemp = minTemp + (maxTemp - minTemp) * 0.6;
                } else { // Winter
                    currentTemp = minTemp + (maxTemp - minTemp) * 0.2;
                }
                
                // Add some random variation
                return Math.round(currentTemp + (Math.random() * 6 - 3));
            }

            generateLocationData(lat, lng, address = 'Unknown Location') {
                const { city, name } = this.findClosestCity(lat, lng, address);
                const month = new Date().getMonth();
                
                // Generate deterministic but realistic data based on location
                const seed = Math.abs(lat * 10000 + lng * 10000);
                const random = (min, max) => {
                    const rand = (Math.sin(seed + min + max) * 10000) % 1;
                    return min + rand * (max - min);
                };

                // Generate realistic values based on city data
                const soilType = this.getSoilType(city.climate);
                const soilPh = this.roundTo(random(city.soil.phRange[0], city.soil.phRange[1]), 1);
                const soilOrganic = this.roundTo(random(city.soil.organicRange[0], city.soil.organicRange[1]), 1);
                const soilMoisture = Math.round(random(city.soil.moistureRange[0], city.soil.moistureRange[1]));
                const waterPh = this.roundTo(random(city.water.phRange[0], city.water.phRange[1]), 1);
                const waterTds = Math.round(random(city.water.tdsRange[0], city.water.tdsRange[1]));
                const ndvi = this.roundTo(random(city.ndviRange[0], city.ndviRange[1]), 2);
                
                // Calculate realistic temperature
                const temperature = this.calculateRealisticTemperature(city, month);

                // Compile all data
                const tempData = {
                    soil: {
                        type: soilType,
                        ph: soilPh,
                        organicMatter: soilOrganic,
                        moisture: soilMoisture,
                        nitrogen: this.roundTo(random(2.0, 5.0), 1)
                    },
                    water: {
                        quality: this.getWaterQuality(waterTds),
                        ph: waterPh,
                        tds: waterTds,
                        nitrates: this.roundTo(random(city.water.nitrateRange[0], city.water.nitrateRange[1]), 1)
                    },
                    air: {
                        aqi: Math.round(random(city.air.aqiRange[0], city.air.aqiRange[1])),
                        co2: Math.round(random(city.air.co2Range[0], city.air.co2Range[1])),
                        humidity: Math.round(random(40, 85)),
                        temperature: temperature
                    },
                    ndvi: {
                        ndvi: ndvi,
                        vegetationHealth: this.getHealthFromNDVI(ndvi),
                        trend: 'Stable'
                    }
                };

                const crops = this.cropRecommender.getOptimalCrops(tempData, city.climate, 6);

                return {
                    region: name,
                    zone: city.climate,
                    zoneName: this.getZoneName(city.climate),
                    coordinates: { lat, lng },
                    soil: tempData.soil,
                    water: tempData.water,
                    air: tempData.air,
                    ndvi: tempData.ndvi,
                    crops: crops
                };
            }

            getSoilType(climate) {
                const soilTypes = {
                    'fertile_plains': ['Alluvial Soil', 'Loam', 'Silty Loam'],
                    'sub_tropical': ['Loam', 'Clay Loam', 'Sandy Loam'],
                    'arid_desert': ['Sandy Soil', 'Desert Soil', 'Aridisol'],
                    'coastal_arid': ['Sandy Loam', 'Coastal Soil', 'Saline Soil'],
                    'mediterranean': ['Clay Loam', 'Mediterranean Red Soil', 'Loam'],
                    'tropical': ['Laterite', 'Clay Loam', 'Red Soil'],
                    'temperate': ['Loam', 'Silty Clay', 'Brown Earth']
                };
                const types = soilTypes[climate] || ['Loam'];
                return types[Math.floor(Math.random() * types.length)];
            }

            getZoneName(climate) {
                const zoneNames = {
                    'fertile_plains': 'Fertile Plains',
                    'sub_tropical': 'Sub-Tropical',
                    'arid_desert': 'Arid Desert',
                    'coastal_arid': 'Coastal Arid',
                    'mediterranean': 'Mediterranean',
                    'tropical': 'Tropical',
                    'temperate': 'Temperate'
                };
                return zoneNames[climate] || 'Agricultural Zone';
            }

            getWaterQuality(tds) {
                if (tds < 100) return 'Excellent';
                if (tds < 300) return 'Good';
                if (tds < 600) return 'Moderate';
                if (tds < 1000) return 'Poor';
                return 'Very Poor';
            }

            getHealthFromNDVI(ndvi) {
                if (ndvi > 0.7) return 'Excellent';
                if (ndvi > 0.5) return 'Good';
                if (ndvi > 0.3) return 'Moderate';
                return 'Poor';
            }

            roundTo(value, decimals) {
                return Number(Math.round(value + 'e' + decimals) + 'e-' + decimals);
            }
        }

        // AdvancedCropRecommender class
        class AdvancedCropRecommender {
            constructor() {
                this.cropDatabase = this.initializeCropDatabase();
                this.seasonalAdjustments = this.initializeSeasonalAdjustments();
            }

            initializeCropDatabase() {
                return {
                    // Grains
                    'Wheat': {
                        emoji: '',
                        type: 'grain',
                        optimalPH: { min: 6.0, max: 7.5, ideal: 6.8 },
                        optimalMoisture: { min: 25, max: 45, ideal: 35 },
                        optimalTemp: { min: 10, max: 25, ideal: 18 },
                        soilTypes: ['loam', 'silty loam', 'clay loam'],
                        waterNeeds: 'medium',
                        climateZones: ['fertile_plains', 'sub_tropical', 'temperate'],
                        season: ['fall', 'winter'],
                        maturityDays: 120,
                        yieldPotential: 'medium'
                    },
                    'Rice': {
                        emoji: '',
                        type: 'grain',
                        optimalPH: { min: 5.5, max: 6.5, ideal: 6.0 },
                        optimalMoisture: { min: 60, max: 85, ideal: 75 },
                        optimalTemp: { min: 20, max: 35, ideal: 28 },
                        soilTypes: ['clay loam', 'clay', 'alluvial soil'],
                        waterNeeds: 'very-high',
                        climateZones: ['fertile_plains', 'sub_tropical', 'tropical'],
                        season: ['spring', 'summer'],
                        maturityDays: 110,
                        yieldPotential: 'high'
                    },
                    'Corn': {
                        emoji: '',
                        type: 'grain',
                        optimalPH: { min: 5.8, max: 7.0, ideal: 6.5 },
                        optimalMoisture: { min: 30, max: 50, ideal: 40 },
                        optimalTemp: { min: 18, max: 32, ideal: 25 },
                        soilTypes: ['loam', 'silty clay', 'clay loam'],
                        waterNeeds: 'medium-high',
                        climateZones: ['fertile_plains', 'sub_tropical', 'temperate'],
                        season: ['spring', 'summer'],
                        maturityDays: 80,
                        yieldPotential: 'high'
                    },

                    // Vegetables
                    'Tomatoes': {
                        emoji: '',
                        type: 'vegetable',
                        optimalPH: { min: 5.5, max: 6.8, ideal: 6.2 },
                        optimalMoisture: { min: 35, max: 55, ideal: 45 },
                        optimalTemp: { min: 18, max: 28, ideal: 23 },
                        soilTypes: ['loam', 'sandy loam', 'clay loam'],
                        waterNeeds: 'medium',
                        climateZones: ['fertile_plains', 'sub_tropical', 'mediterranean'],
                        season: ['spring', 'summer'],
                        maturityDays: 70,
                        yieldPotential: 'high'
                    },
                    'Potatoes': {
                        emoji: '',
                        type: 'vegetable',
                        optimalPH: { min: 5.0, max: 6.5, ideal: 5.8 },
                        optimalMoisture: { min: 40, max: 60, ideal: 50 },
                        optimalTemp: { min: 15, max: 25, ideal: 20 },
                        soilTypes: ['sandy loam', 'loam'],
                        waterNeeds: 'medium-high',
                        climateZones: ['fertile_plains', 'sub_tropical', 'temperate'],
                        season: ['spring', 'fall'],
                        maturityDays: 90,
                        yieldPotential: 'medium'
                    },

                    // Fruits
                    'Citrus': {
                        emoji: '',
                        type: 'fruit',
                        optimalPH: { min: 6.0, max: 7.5, ideal: 6.5 },
                        optimalMoisture: { min: 30, max: 50, ideal: 40 },
                        optimalTemp: { min: 13, max: 35, ideal: 25 },
                        soilTypes: ['sandy loam', 'loam'],
                        waterNeeds: 'medium',
                        climateZones: ['mediterranean', 'tropical', 'sub_tropical'],
                        season: ['year-round'],
                        maturityDays: 270,
                        yieldPotential: 'medium'
                    },
                    'Grapes': {
                        emoji: '',
                        type: 'fruit',
                        optimalPH: { min: 5.5, max: 7.0, ideal: 6.2 },
                        optimalMoisture: { min: 20, max: 40, ideal: 30 },
                        optimalTemp: { min: 15, max: 30, ideal: 22 },
                        soilTypes: ['gravelly loam', 'sandy loam'],
                        waterNeeds: 'low-medium',
                        climateZones: ['mediterranean', 'temperate'],
                        season: ['spring', 'summer'],
                        maturityDays: 180,
                        yieldPotential: 'medium'
                    },

                    // Cash crops
                    'Sugarcane': {
                        emoji: '',
                        type: 'cash',
                        optimalPH: { min: 5.0, max: 8.5, ideal: 6.5 },
                        optimalMoisture: { min: 50, max: 75, ideal: 65 },
                        optimalTemp: { min: 20, max: 35, ideal: 28 },
                        soilTypes: ['clay loam', 'sandy loam', 'alluvial soil'],
                        waterNeeds: 'high',
                        climateZones: ['fertile_plains', 'tropical', 'sub_tropical'],
                        season: ['spring', 'summer'],
                        maturityDays: 300,
                        yieldPotential: 'high'
                    },
                    'Cotton': {
                        emoji: '',
                        type: 'cash',
                        optimalPH: { min: 5.5, max: 7.5, ideal: 6.5 },
                        optimalMoisture: { min: 25, max: 45, ideal: 35 },
                        optimalTemp: { min: 20, max: 35, ideal: 28 },
                        soilTypes: ['sandy loam', 'loam'],
                        waterNeeds: 'medium',
                        climateZones: ['fertile_plains', 'sub_tropical'],
                        season: ['spring', 'summer'],
                        maturityDays: 160,
                        yieldPotential: 'medium'
                    },

                    // Specialty crops for arid regions
                    'Dates': {
                        emoji: '',
                        type: 'fruit',
                        optimalPH: { min: 7.0, max: 8.5, ideal: 8.0 },
                        optimalMoisture: { min: 5, max: 25, ideal: 15 },
                        optimalTemp: { min: 20, max: 45, ideal: 35 },
                        soilTypes: ['sandy soil', 'desert soil', 'sandy loam'],
                        waterNeeds: 'very-low',
                        climateZones: ['arid_desert', 'coastal_arid'],
                        season: ['year-round'],
                        maturityDays: 180,
                        yieldPotential: 'medium'
                    },
                    'Barley': {
                        emoji: '',
                        type: 'grain',
                        optimalPH: { min: 6.0, max: 8.0, ideal: 7.0 },
                        optimalMoisture: { min: 15, max: 35, ideal: 25 },
                        optimalTemp: { min: 12, max: 30, ideal: 20 },
                        soilTypes: ['sandy loam', 'loam'],
                        waterNeeds: 'low',
                        climateZones: ['arid_desert', 'temperate', 'fertile_plains'],
                        season: ['fall', 'winter'],
                        maturityDays: 90,
                        yieldPotential: 'medium'
                    }
                };
            }

            initializeSeasonalAdjustments() {
                const currentMonth = new Date().getMonth();
                return {
                    'spring': [2, 3, 4],  // March, April, May
                    'summer': [5, 6, 7],  // June, July, August
                    'fall': [8, 9, 10],   // September, October, November
                    'winter': [11, 0, 1]  // December, January, February
                };
            }

            getCurrentSeason() {
                const currentMonth = new Date().getMonth();
                for (const [season, months] of Object.entries(this.seasonalAdjustments)) {
                    if (months.includes(currentMonth)) {
                        return season;
                    }
                }
                return 'summer'; // Default
            }

            calculateCropScore(crop, farmData, climateZone) {
                let totalScore = 0;
                const weights = {
                    ph: 25,
                    moisture: 20,
                    temperature: 20,
                    soilType: 15,
                    season: 10,
                    climateZone: 10
                };

                // pH Score
                const phScore = this.calculatePHScore(crop.optimalPH, farmData.soil.ph);
                totalScore += phScore * weights.ph;

                // Moisture Score
                const moistureScore = this.calculateMoistureScore(crop.optimalMoisture, farmData.soil.moisture);
                totalScore += moistureScore * weights.moisture;

                // Temperature Score
                const tempScore = this.calculateTemperatureScore(crop.optimalTemp, farmData.air.temperature);
                totalScore += tempScore * weights.temperature;

                // Soil Type Score
                const soilTypeScore = this.calculateSoilTypeScore(crop.soilTypes, farmData.soil.type);
                totalScore += soilTypeScore * weights.soilType;

                // Season Score
                const seasonScore = this.calculateSeasonScore(crop.season, this.getCurrentSeason());
                totalScore += seasonScore * weights.season;

                // Climate Zone Score
                const zoneScore = this.calculateZoneScore(crop.climateZones, climateZone);
                totalScore += zoneScore * weights.climateZone;

                return Math.min(Math.round(totalScore), 100);
            }

            calculatePHScore(optimalPH, actualPH) {
                const ideal = optimalPH.ideal;
                const min = optimalPH.min;
                const max = optimalPH.max;
                
                if (actualPH >= min && actualPH <= max) {
                    if (Math.abs(actualPH - ideal) <= 0.3) return 1.0; // Very close to ideal
                    if (Math.abs(actualPH - ideal) <= 0.6) return 0.8; // Close to ideal
                    return 0.6; // Within range but not close to ideal
                }
                
                // Outside optimal range - penalize based on distance
                const distance = Math.min(
                    Math.abs(actualPH - min),
                    Math.abs(actualPH - max)
                );
                return Math.max(0, 1 - (distance * 0.5));
            }

            calculateMoistureScore(optimalMoisture, actualMoisture) {
                const ideal = optimalMoisture.ideal;
                const min = optimalMoisture.min;
                const max = optimalMoisture.max;
                
                if (actualMoisture >= min && actualMoisture <= max) {
                    if (Math.abs(actualMoisture - ideal) <= 5) return 1.0;
                    if (Math.abs(actualMoisture - ideal) <= 10) return 0.8;
                    return 0.6;
                }
                
                const distance = Math.min(
                    Math.abs(actualMoisture - min),
                    Math.abs(actualMoisture - max)
                );
                return Math.max(0, 1 - (distance * 0.05));
            }

            calculateTemperatureScore(optimalTemp, actualTemp) {
                const ideal = optimalTemp.ideal;
                const min = optimalTemp.min;
                const max = optimalTemp.max;
                
                if (actualTemp >= min && actualTemp <= max) {
                    if (Math.abs(actualTemp - ideal) <= 3) return 1.0;
                    if (Math.abs(actualTemp - ideal) <= 6) return 0.8;
                    return 0.6;
                }
                
                const distance = Math.min(
                    Math.abs(actualTemp - min),
                    Math.abs(actualTemp - max)
                );
                return Math.max(0, 1 - (distance * 0.05));
            }

            calculateSoilTypeScore(preferredTypes, actualType) {
                const actualLower = actualType.toLowerCase();
                for (const preferred of preferredTypes) {
                    if (actualLower.includes(preferred.toLowerCase())) {
                        return 1.0;
                    }
                }
                return 0.3; // Partial match
            }

            calculateSeasonScore(cropSeasons, currentSeason) {
                return cropSeasons.includes(currentSeason) ? 1.0 : 0.2;
            }

            calculateZoneScore(preferredZones, actualZone) {
                return preferredZones.includes(actualZone) ? 1.0 : 0.3;
            }

            generateRecommendationReason(crop, farmData, score) {
                const reasons = [];
                const cropData = this.cropDatabase[crop];

                // pH analysis
                if (farmData.soil.ph < cropData.optimalPH.min) {
                    reasons.push(`Soil pH (${farmData.soil.ph}) is slightly acidic for optimal growth`);
                } else if (farmData.soil.ph > cropData.optimalPH.max) {
                    reasons.push(`Soil pH (${farmData.soil.ph}) is slightly alkaline for optimal growth`);
                } else {
                    reasons.push(`Soil pH (${farmData.soil.ph}) is within optimal range`);
                }

                // Moisture analysis
                if (farmData.soil.moisture < cropData.optimalMoisture.min) {
                    reasons.push(`Additional irrigation recommended (current moisture: ${farmData.soil.moisture}%)`);
                } else if (farmData.soil.moisture > cropData.optimalMoisture.max) {
                    reasons.push(`Good moisture levels (${farmData.soil.moisture}%) but monitor for drainage`);
                } else {
                    reasons.push(`Soil moisture (${farmData.soil.moisture}%) is ideal`);
                }

                // Temperature analysis
                if (farmData.air.temperature < cropData.optimalTemp.min) {
                    reasons.push(`Temperature (${farmData.air.temperature}C) is below optimal - consider season extension`);
                } else if (farmData.air.temperature > cropData.optimalTemp.max) {
                    reasons.push(`Temperature (${farmData.air.temperature}C) is above optimal - provide shade if possible`);
                } else {
                    reasons.push(`Temperature (${farmData.air.temperature}C) is optimal`);
                }

                // Season analysis
                const currentSeason = this.getCurrentSeason();
                if (!cropData.season.includes(currentSeason)) {
                    reasons.push(`Not ideal season (${currentSeason}) - consider greenhouse cultivation`);
                }

                return reasons.join('. ');
            }

            getOptimalCrops(farmData, climateZone, limit = 6) {
                const scoredCrops = [];

                for (const [cropName, cropData] of Object.entries(this.cropDatabase)) {
                    const score = this.calculateCropScore(cropData, farmData, climateZone);
                    const reason = this.generateRecommendationReason(cropName, farmData, score);
                    
                    scoredCrops.push({
                        name: cropName,
                        match: score,
                        reason: reason,
                        emoji: cropData.emoji,
                        type: cropData.type,
                        maturity: cropData.maturityDays,
                        yield: cropData.yieldPotential
                    });
                }

                // Sort by score and return top results
                return scoredCrops
                    .sort((a, b) => b.match - a.match)
                    .slice(0, limit)
                    .filter(crop => crop.match >= 60); // Only include crops with decent match
            }
        }

        // EnhancedNasaAPI class
        class EnhancedNasaAPI {
            constructor() {
                this.locationData = new CityBasedAgriculturalData();
            }

            async getRealClimateData(lat, lon) {
                const locationData = this.locationData.generateLocationData(lat, lon);
                return {
                    temperature: locationData.air.temperature,
                    precipitation: this.getPrecipitationFromZone(locationData.zone),
                    windSpeed: locationData.air.windSpeed || 3.5,
                    humidity: locationData.air.humidity,
                    solarRadiation: 18.5,
                    source: 'Enhanced Location Simulation',
                    region: locationData.region,
                    zone: locationData.zoneName
                };
            }

            async getRealNDVIData(lat, lon) {
                const locationData = this.locationData.generateLocationData(lat, lon);
                return locationData.ndvi;
            }

            async getRealSoilMoisture(lat, lon) {
                const locationData = this.locationData.generateLocationData(lat, lon);
                return {
                    surfaceMoisture: locationData.soil.moisture / 100,
                    rootZoneMoisture: (locationData.soil.moisture - 5) / 100,
                    moistureAnomaly: locationData.soil.moisture < 15 ? 'Low' : 'Normal',
                    source: 'Enhanced Location Simulation'
                };
            }

            getPrecipitationFromZone(zone) {
                const precipMap = {
                    'fertile_plains': 600,
                    'sub_tropical': 800,
                    'arid_desert': 100,
                    'coastal_arid': 150,
                    'mediterranean': 500,
                    'tropical': 1200,
                    'temperate': 700
                };
                return precipMap[zone] || 500;
            }
        }

        // Market Data API
        class MarketDataAPI {
            constructor() {
                this.vegetableData = this.initializeVegetableData();
            }

            initializeVegetableData() {
                return [
                    { name: 'Tomatoes', icon: '', currentPrice: 45, change: 2.5, unit: 'kg' },
                    { name: 'Potatoes', icon: '', currentPrice: 25, change: -1.2, unit: 'kg' },
                    { name: 'Onions', icon: '', currentPrice: 30, change: 5.7, unit: 'kg' },
                    { name: 'Carrots', icon: '', currentPrice: 40, change: 0.8, unit: 'kg' },
                    { name: 'Bell Peppers', icon: '', currentPrice: 60, change: -3.1, unit: 'kg' },
                    { name: 'Cabbage', icon: '', currentPrice: 20, change: 1.5, unit: 'kg' },
                    { name: 'Cauliflower', icon: '', currentPrice: 35, change: 2.1, unit: 'kg' },
                    { name: 'Spinach', icon: '', currentPrice: 50, change: -0.5, unit: 'kg' }
                ];
            }

            getPriceHistoryForVegetable(vegetableName, timeframe) {
                // Generate realistic price history based on timeframe
                const months = timeframe === '1M' ? 1 : timeframe === '3M' ? 3 : timeframe === '6M' ? 6 : 12;
                const dataPoints = months * 4; // Weekly data
                
                const history = [];
                const baseDate = new Date();
                const vegetable = this.vegetableData.find(v => v.name === vegetableName);
                const basePrice = vegetable ? vegetable.currentPrice : 30;
                
                for (let i = dataPoints; i >= 0; i--) {
                    const date = new Date(baseDate);
                    date.setDate(date.getDate() - i * 7); // Weekly intervals
                    
                    // Generate price with seasonal variation and random fluctuation
                    const seasonalFactor = this.getSeasonalFactor(vegetableName, date);
                    const fluctuation = (Math.sin(i * 0.5) + Math.random() * 0.5 - 0.25) * 10;
                    const price = Math.max(10, (basePrice * seasonalFactor) + fluctuation);
                    
                    history.push({
                        date: date.toISOString().split('T')[0],
                        price: Math.round(price * 100) / 100
                    });
                }
                
                return history;
            }

            getSeasonalFactor(vegetableName, date) {
                const month = date.getMonth();
                
                const seasonalPatterns = {
                    'Tomatoes': [0.8, 0.8, 0.9, 1.0, 1.2, 1.5, 1.8, 1.5, 1.2, 1.0, 0.9, 0.8], // Peak in summer
                    'Potatoes': [1.1, 1.0, 0.9, 0.8, 0.7, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.2], // Peak in winter
                    'Onions': [1.0, 1.0, 1.0, 0.9, 0.8, 0.7, 0.7, 0.8, 0.9, 1.0, 1.1, 1.1],
                    'Carrots': [1.1, 1.0, 0.9, 0.8, 0.7, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.2],
                    'Bell Peppers': [0.8, 0.8, 0.9, 1.0, 1.2, 1.5, 1.8, 1.5, 1.2, 1.0, 0.9, 0.8],
                    'Cabbage': [1.0, 1.0, 1.0, 0.9, 0.8, 0.7, 0.7, 0.8, 0.9, 1.0, 1.1, 1.1],
                    'Cauliflower': [1.1, 1.0, 0.9, 0.8, 0.7, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.2],
                    'Spinach': [1.2, 1.1, 1.0, 0.9, 0.8, 0.7, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2]
                };
                
                return seasonalPatterns[vegetableName] ? seasonalPatterns[vegetableName][month] : 1.0;
            }

            getMarketShareData() {
                return [
                    { vegetable: 'Tomatoes', share: 25 },
                    { vegetable: 'Potatoes', share: 20 },
                    { vegetable: 'Onions', share: 15 },
                    { vegetable: 'Carrots', share: 12 },
                    { vegetable: 'Bell Peppers', share: 10 },
                    { vegetable: 'Cabbage', share: 8 },
                    { vegetable: 'Others', share: 10 }
                ];
            }
        }

        // Global variables
        let map;
        let marker;
        let currentLocation = { lat: 31.6340, lng: 74.8723 }; // Default to Amritsar
        let geocoder;
        let selectedLocation = null;
        let isSidebarCollapsed = false;
        let currentUser = null;
        let currentCarouselIndex = 0;
        let carouselItems = [];
        let currentAddress = '';
        let currentTimeframe = '1M';
        let selectedVegetable = 'Tomatoes';

        // Chart instances
        let soilPieChart, waterBarChart, windChart, satelliteChart, priceTrendChart, marketShareChart;

        const locationDataGenerator = new CityBasedAgriculturalData();
        const nasaAPI = new EnhancedNasaAPI();
        const marketDataAPI = new MarketDataAPI();
        let currentFarmData = {};

        // Utility functions
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast';
            if (isError) toast.classList.add('error');
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username && password) {
                currentUser = {
                    name: username.charAt(0).toUpperCase() + username.slice(1),
                    initial: username.charAt(0).toUpperCase(),
                    username: username,
                    loginDate: new Date().toLocaleString(),
                    createdDate: new Date().toLocaleString()
                };
                
                document.getElementById('user-name').textContent = currentUser.name;
                document.getElementById('user-avatar').textContent = currentUser.initial;
                document.getElementById('account-name').textContent = currentUser.name;
                document.getElementById('account-username').textContent = currentUser.username;
                document.getElementById('account-avatar').textContent = currentUser.initial;
                document.getElementById('account-login-date').textContent = currentUser.loginDate;
                document.getElementById('account-created-date').textContent = currentUser.createdDate;
                
                document.getElementById('login-page').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                
                showToast(`Welcome ${currentUser.name}!`);
                
                if (typeof google !== 'undefined') {
                    initMap();
                }
                
                // Initialize charts after a short delay
                setTimeout(initializeCharts, 1000);
            } else {
                showToast('Please enter credentials', true);
            }
        }

        // NEW: Create Account Functionality
        function toggleLoginForm() {
            const loginForm = document.getElementById('login-form');
            const createAccountForm = document.getElementById('create-account-form');
            const formToggleText = document.getElementById('form-toggle-text');
            
            if (loginForm.style.display !== 'none') {
                // Switch to create account form
                loginForm.style.display = 'none';
                createAccountForm.classList.add('active');
                formToggleText.innerHTML = translations[currentLanguage]['already_account'] + ' <a href="#" id="form-toggle-link">' + translations[currentLanguage]['sign_in'] + '</a>';
            } else {
                // Switch to login form
                loginForm.style.display = 'block';
                createAccountForm.classList.remove('active');
                formToggleText.innerHTML = translations[currentLanguage]['no_account'] + ' <a href="#" id="form-toggle-link">' + translations[currentLanguage]['create_account_link'] + '</a>';
            }
            
            // Reattach event listener to the new toggle link
            document.getElementById('form-toggle-link').addEventListener('click', function(e) {
                e.preventDefault();
                toggleLoginForm();
            });
        }

        function handleCreateAccount(event) {
            event.preventDefault();
            
            const username = document.getElementById('new-username').value;
            const password = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!username || !password || !confirmPassword) {
                showToast('Please fill all fields', true);
                return;
            }
            
            if (password !== confirmPassword) {
                showToast('Passwords do not match', true);
                return;
            }
            
            // Create user account
            currentUser = {
                name: username.charAt(0).toUpperCase() + username.slice(1),
                initial: username.charAt(0).toUpperCase(),
                username: username,
                password: password,
                loginDate: new Date().toLocaleString(),
                createdDate: new Date().toLocaleString()
            };
            
            // Save user data
            localStorage.setItem('userData', JSON.stringify(currentUser));
            
            // Update UI with user data
            document.getElementById('user-name').textContent = currentUser.name;
            document.getElementById('user-avatar').textContent = currentUser.initial;
            document.getElementById('account-name').textContent = currentUser.name;
            document.getElementById('account-username').textContent = currentUser.username;
            document.getElementById('account-avatar').textContent = currentUser.initial;
            document.getElementById('account-login-date').textContent = currentUser.loginDate;
            document.getElementById('account-created-date').textContent = currentUser.createdDate;
            
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            
            showToast(`Account created successfully! Welcome ${currentUser.name}!`);
            
            if (typeof google !== 'undefined') {
                initMap();
            }
            
            // Initialize charts after a short delay
            setTimeout(initializeCharts, 1000);
        }

        // NEW: Toggle Password Visibility
        function togglePasswordVisibility(inputId, buttonId) {
            const passwordInput = document.getElementById(inputId);
            const toggleButton = document.getElementById(buttonId);
            const icon = toggleButton.querySelector('i');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                passwordInput.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        // NEW: Show Account Password
        function toggleAccountPassword() {
            const passwordSpan = document.getElementById('account-password');
            const toggleButton = document.getElementById('toggle-account-password');
            const icon = toggleButton.querySelector('i');
            
            if (passwordSpan.textContent === '') {
                passwordSpan.textContent = currentUser.password;
                icon.className = 'fas fa-eye-slash';
            } else {
                passwordSpan.textContent = '';
                icon.className = 'fas fa-eye';
            }
        }

        // NEW: Logout Function
        function logout() {
            // Clear user data
            currentUser = null;
            localStorage.removeItem('demoUser');
            localStorage.removeItem('userData');
            
            // Show login page
            document.getElementById('login-page').style.display = 'flex';
            document.getElementById('app').style.display = 'none';
            
            // Reset forms
            document.getElementById('login-form').reset();
            document.getElementById('create-account-form').reset();
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('create-account-form').classList.remove('active');
            
            // Reset form toggle text
            document.getElementById('form-toggle-text').innerHTML = translations[currentLanguage]['no_account'] + ' <a href="#" id="form-toggle-link">' + translations[currentLanguage]['create_account_link'] + '</a>';
            
            showToast('You have been logged out successfully');
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const themeBtn = document.getElementById('theme-btn');
            const icon = themeBtn.querySelector('i');
            icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const toggleIcon = document.querySelector('#toggle-sidebar i');
            
            isSidebarCollapsed = !isSidebarCollapsed;
            
            if (isSidebarCollapsed) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('expanded');
                toggleIcon.className = 'fas fa-chevron-right';
            } else {
                sidebar.classList.remove('collapsed');
                mainContent.classList.remove('expanded');
                toggleIcon.className = 'fas fa-chevron-left';
            }
        }

        function navigateToPage(pageId) {
            document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            
            document.querySelector(`.sidebar-link[data-page="${pageId}"]`).classList.add('active');
            document.getElementById(pageId).classList.add('active');
            
            const pageTitle = document.querySelector('.page-title');
            switch(pageId) {
                case 'dashboard': 
                    pageTitle.innerHTML = `<span data-i18n="dashboard">Dashboard</span>
                                          <span class="nasa-badge"><i class="fas fa-satellite"></i> <span data-i18n="nasa_powered">NASA POWERED</span></span>`;
                    changeLanguage(currentLanguage); // Refresh translations
                    break;
                case 'analysis': 
                    pageTitle.innerHTML = `<span data-i18n="analysis">Analysis</span>
                                          <span class="nasa-badge"><i class="fas fa-satellite"></i> <span data-i18n="nasa_powered">NASA POWERED</span></span>`;
                    changeLanguage(currentLanguage); // Refresh translations
                    setTimeout(initializeCharts, 300);
                    break;
                case 'recommendations': 
                    pageTitle.innerHTML = `<span data-i18n="recommendations">Recommendations</span>
                                          <span class="nasa-badge"><i class="fas fa-satellite"></i> <span data-i18n="nasa_powered">NASA POWERED</span></span>`;
                    changeLanguage(currentLanguage); // Refresh translations
                    updateCarouselWithRealData();
                    break;
                case 'crop-lens': 
                    pageTitle.innerHTML = `<span data-i18n="crop_lens">CropLens AI</span>
                                          <span class="nasa-badge"><i class="fas fa-satellite"></i> <span data-i18n="nasa_powered">NASA POWERED</span></span>`;
                    changeLanguage(currentLanguage); // Refresh translations
                    break;
                case 'market-trends': 
                    pageTitle.innerHTML = `<span data-i18n="market_trends">Market Trends</span>
                                          <span class="nasa-badge"><i class="fas fa-satellite"></i> <span data-i18n="nasa_powered">NASA POWERED</span></span>`;
                    changeLanguage(currentLanguage); // Refresh translations
                    setTimeout(initializeCharts, 300);
                    break;
                case 'account': 
                    pageTitle.innerHTML = `<span data-i18n="account">Account</span>
                                          <span class="nasa-badge"><i class="fas fa-satellite"></i> <span data-i18n="nasa_powered">NASA POWERED</span></span>`;
                    changeLanguage(currentLanguage); // Refresh translations
                    break;
            }
        }

        function initMap() {
            geocoder = new google.maps.Geocoder();
            
            map = new google.maps.Map(document.getElementById('map'), {
                center: currentLocation,
                zoom: 12,
                styles: [
                    {
                        featureType: 'poi',
                        elementType: 'labels',
                        stylers: [{ visibility: 'off' }]
                    }
                ]
            });
            
            marker = new google.maps.Marker({
                position: currentLocation,
                map: map,
                draggable: true,
                animation: google.maps.Animation.DROP,
                title: 'Your Farm Location'
            });
            
            // Update location when marker is dragged
            marker.addListener('dragend', function() {
                updateLocationFromMarker(marker.getPosition());
            });
            
            // Update location when map is clicked
            map.addListener('click', function(event) {
                marker.setPosition(event.latLng);
                updateLocationFromMarker(event.latLng);
            });
            
            // Initial location update
            updateLocationFromMarker(currentLocation);
        }

        function updateLocationFromMarker(position) {
            currentLocation = {
                lat: position.lat(),
                lng: position.lng()
            };
            
            document.getElementById('latitude').textContent = currentLocation.lat.toFixed(6);
            document.getElementById('longitude').textContent = currentLocation.lng.toFixed(6);
            
            // Get address from coordinates
            geocoder.geocode({ location: currentLocation }, function(results, status) {
                if (status === 'OK' && results[0]) {
                    currentAddress = results[0].formatted_address;
                    document.getElementById('address').textContent = currentAddress;
                    
                    // Generate realistic farm data based on location
                    generateFarmData(currentLocation.lat, currentLocation.lng, currentAddress);
                } else {
                    document.getElementById('address').textContent = 'Address not found';
                    generateFarmData(currentLocation.lat, currentLocation.lng, 'Unknown Location');
                }
            });
        }

        function generateFarmData(lat, lng, address) {
            currentFarmData = locationDataGenerator.generateLocationData(lat, lng, address);
            
            // Update NDVI and Soil Moisture values
            document.getElementById('ndvi-value').textContent = currentFarmData.ndvi.ndvi;
            document.getElementById('soil-moisture').textContent = currentFarmData.soil.moisture + '%';
            
            // Update analysis location text
            document.getElementById('analysis-location-text').textContent = 
                `Analyzing data for ${currentFarmData.region}, ${currentFarmData.zoneName}`;
            
            // Update analysis tab values
            document.getElementById('soil-ph').textContent = currentFarmData.soil.ph + ' pH';
            document.getElementById('soil-moisture-analysis').textContent = currentFarmData.soil.moisture + '%';
            document.getElementById('soil-organic').textContent = currentFarmData.soil.organicMatter + '%';
            document.getElementById('soil-nutrients').textContent = 'High';
            
            document.getElementById('water-ph').textContent = currentFarmData.water.ph + ' pH';
            document.getElementById('water-tds').textContent = currentFarmData.water.tds + ' ppm';
            document.getElementById('water-nitrates').textContent = currentFarmData.water.nitrates + ' mg/L';
            document.getElementById('water-quality').textContent = currentFarmData.water.quality;
            
            document.getElementById('air-aqi').textContent = currentFarmData.air.aqi + ' AQI';
            document.getElementById('air-co2').textContent = currentFarmData.air.co2 + ' ppm';
            document.getElementById('air-humidity').textContent = currentFarmData.air.humidity + '%';
            document.getElementById('air-temperature').textContent = currentFarmData.air.temperature + 'C';
            
            document.getElementById('satellite-ndvi').textContent = currentFarmData.ndvi.ndvi;
            document.getElementById('satellite-moisture').textContent = currentFarmData.soil.moisture / 100;
            document.getElementById('satellite-temp').textContent = currentFarmData.air.temperature + 'C';
            document.getElementById('satellite-health').textContent = currentFarmData.ndvi.vegetationHealth;
            
            // Update charts if they exist
            if (soilPieChart) updateSoilPieChart();
            if (waterBarChart) updateWaterBarChart();
            if (windChart) updateWindChart();
            if (satelliteChart) updateSatelliteChart();
            
            // Update recommendations
            updateCarouselWithRealData();
        }

        function searchLocation() {
            const address = prompt('Enter location (city, address, or coordinates):');
            if (address) {
                geocoder.geocode({ address: address }, function(results, status) {
                    if (status === 'OK' && results[0]) {
                        const location = results[0].geometry.location;
                        map.setCenter(location);
                        marker.setPosition(location);
                        updateLocationFromMarker(location);
                        showToast('Location found and updated');
                    } else {
                        showToast('Location not found. Please try again.', true);
                    }
                });
            }
        }

        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const location = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        
                        map.setCenter(location);
                        marker.setPosition(location);
                        updateLocationFromMarker(location);
                        showToast('Current location retrieved');
                    },
                    function() {
                        showToast('Unable to retrieve your location', true);
                    }
                );
            } else {
                showToast('Geolocation is not supported by this browser', true);
            }
        }

        function fetchNASAData() {
            const nasaStatus = document.getElementById('nasa-status');
            nasaStatus.innerHTML = '<i class="fas fa-satellite"></i> <span data-i18n="nasa_connected">NASA API Connected</span>';
            nasaStatus.classList.add('active');
            
            showToast('Fetching latest NASA satellite data...');
            
            // Simulate API call delay
            setTimeout(() => {
                // Generate new data with slight variations
                generateFarmData(currentLocation.lat, currentLocation.lng, currentAddress);
                showToast('NASA satellite data updated successfully');
            }, 2000);
        }

        function saveLocation() {
            if (currentFarmData && currentFarmData.region) {
                const savedLocations = JSON.parse(localStorage.getItem('savedLocations') || '[]');
                savedLocations.push({
                    location: currentLocation,
                    address: currentAddress,
                    data: currentFarmData,
                    timestamp: new Date().toISOString()
                });
                
                localStorage.setItem('savedLocations', JSON.stringify(savedLocations));
                showToast('Location saved successfully');
            } else {
                showToast('No location data to save', true);
            }
        }

        function showDetailedAnalysis() {
            navigateToPage('analysis');
        }

        function initializeCharts() {
            // Soil Pie Chart
            const soilCtx = document.getElementById('soilPieChart').getContext('2d');
            soilPieChart = new Chart(soilCtx, {
                type: 'pie',
                data: {
                    labels: ['Organic Matter', 'Minerals', 'Water', 'Air'],
                    datasets: [{
                        data: [4.2, 45, 38, 12.8],
                        backgroundColor: ['#8B4513', '#A0522D', '#20B2AA', '#2E8B57']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        }
                    }
                }
            });

            // Water Bar Chart
            const waterCtx = document.getElementById('waterBarChart').getContext('2d');
            waterBarChart = new Chart(waterCtx, {
                type: 'bar',
                data: {
                    labels: ['pH', 'TDS', 'Nitrates', 'Hardness'],
                    datasets: [{
                        label: 'Water Quality Parameters',
                        data: [7.1, 85, 0.5, 120],
                        backgroundColor: '#20B2AA'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        },
                        x: {
                            grid: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        }
                    }
                }
            });

            // Wind Chart
            const windCtx = document.getElementById('windChart').getContext('2d');
            windChart = new Chart(windCtx, {
                type: 'radar',
                data: {
                    labels: ['Temperature', 'Humidity', 'CO2', 'AQI', 'Wind Speed', 'Pressure'],
                    datasets: [{
                        label: 'Air Quality Index',
                        data: [24, 65, 415, 15, 3.5, 1013],
                        backgroundColor: 'rgba(46, 139, 87, 0.2)',
                        borderColor: '#2E8B57',
                        pointBackgroundColor: '#2E8B57'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            grid: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            pointLabels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color'),
                                backdropColor: 'transparent'
                            }
                        }
                    }
                }
            });

            // Satellite Chart
            const satelliteCtx = document.getElementById('satelliteChart').getContext('2d');
            satelliteChart = new Chart(satelliteCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'NDVI Index',
                        data: [0.65, 0.68, 0.72, 0.75, 0.78, 0.80, 0.82, 0.80, 0.77, 0.73, 0.69, 0.66],
                        borderColor: '#2E8B57',
                        backgroundColor: 'rgba(46, 139, 87, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            min: 0,
                            max: 1,
                            grid: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        },
                        x: {
                            grid: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        }
                    }
                }
            });

            // Price Trend Chart
            const priceTrendCtx = document.getElementById('priceTrendChart').getContext('2d');
            priceTrendChart = new Chart(priceTrendCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Price (/kg)',
                        data: [],
                        borderColor: '#2E8B57',
                        backgroundColor: 'rgba(46, 139, 87, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            grid: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        },
                        x: {
                            grid: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--border-color')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        }
                    }
                }
            });

            // Market Share Chart
            const marketShareCtx = document.getElementById('marketShareChart').getContext('2d');
            marketShareChart = new Chart(marketShareCtx, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [
                            '#2E8B57', '#3CB371', '#20B2AA', '#8B4513', 
                            '#A0522D', '#FFD700', '#FF8C00'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                            }
                        }
                    }
                }
            });

            // Initialize market data
            updatePriceCards();
            updatePriceTrendChart();
            updateMarketShareChart();
        }

        function updateSoilPieChart() {
            if (soilPieChart && currentFarmData.soil) {
                soilPieChart.data.datasets[0].data = [
                    currentFarmData.soil.organicMatter,
                    100 - currentFarmData.soil.organicMatter - currentFarmData.soil.moisture - 12.8,
                    currentFarmData.soil.moisture,
                    12.8
                ];
                soilPieChart.update();
            }
        }

        function updateWaterBarChart() {
            if (waterBarChart && currentFarmData.water) {
                waterBarChart.data.datasets[0].data = [
                    currentFarmData.water.ph,
                    currentFarmData.water.tds,
                    currentFarmData.water.nitrates,
                    120 // Hardness (static for now)
                ];
                waterBarChart.update();
            }
        }

        function updateWindChart() {
            if (windChart && currentFarmData.air) {
                windChart.data.datasets[0].data = [
                    currentFarmData.air.temperature,
                    currentFarmData.air.humidity,
                    currentFarmData.air.co2,
                    currentFarmData.air.aqi,
                    3.5, // Wind speed (static)
                    1013 // Pressure (static)
                ];
                windChart.update();
            }
        }

        function updateSatelliteChart() {
            // This would typically update with real historical data
            // For now, we'll just update the current value in the data array
            if (satelliteChart && currentFarmData.ndvi) {
                const currentMonth = new Date().getMonth();
                satelliteChart.data.datasets[0].data[currentMonth] = currentFarmData.ndvi.ndvi;
                satelliteChart.update();
            }
        }

        function updateCarouselWithRealData() {
            const carousel = document.getElementById('carousel');
            const controls = document.getElementById('carousel-controls');
            
            if (!currentFarmData.crops || currentFarmData.crops.length === 0) {
                carousel.innerHTML = `
                    <div class="carousel-item">
                        <div class="crop-emoji"></div>
                        <h3 class="crop-name">No Crops Recommended</h3>
                        <p class="crop-description">Update your location to get crop recommendations based on soil, water, and climate conditions.</p>
                    </div>
                `;
                return;
            }
            
            carouselItems = currentFarmData.crops;
            carousel.innerHTML = '';
            controls.innerHTML = '';
            
            carouselItems.forEach((crop, index) => {
                const carouselItem = document.createElement('div');
                carouselItem.className = 'carousel-item';
                carouselItem.innerHTML = `
                    <div class="crop-emoji">${crop.emoji}</div>
                    <h3 class="crop-name">${crop.name} <span class="match-badge">${crop.match}% Match</span></h3>
                    <p class="crop-description">${crop.reason}</p>
                    <div class="nasa-data">
                        <h4><i class="fas fa-satellite"></i> NASA Data Insights</h4>
                        <ul>
                            <li><i class="fas fa-check-circle"></i> Optimal for ${currentFarmData.zoneName} climate</li>
                            <li><i class="fas fa-temperature-low"></i> Ideal temperature: ${currentFarmData.air.temperature}C</li>
                            <li><i class="fas fa-tint"></i> Soil moisture: ${currentFarmData.soil.moisture}%</li>
                            <li><i class="fas fa-leaf"></i> Vegetation health: ${currentFarmData.ndvi.vegetationHealth}</li>
                        </ul>
                    </div>
                `;
                carousel.appendChild(carouselItem);
                
                const controlBtn = document.createElement('button');
                controlBtn.className = `carousel-btn ${index === 0 ? 'active' : ''}`;
                controlBtn.addEventListener('click', () => navigateCarousel(index));
                controls.appendChild(controlBtn);
            });
            
            currentCarouselIndex = 0;
            updateCarouselPosition();
        }

        function navigateCarousel(index) {
            currentCarouselIndex = index;
            updateCarouselPosition();
            
            document.querySelectorAll('.carousel-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
        }

        function updateCarouselPosition() {
            const carousel = document.getElementById('carousel');
            carousel.style.transform = `translateX(-${currentCarouselIndex * 100}%)`;
        }

        function nextCarouselItem() {
            currentCarouselIndex = (currentCarouselIndex + 1) % carouselItems.length;
            updateCarouselPosition();
            
            document.querySelectorAll('.carousel-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === currentCarouselIndex);
            });
        }

        function prevCarouselItem() {
            currentCarouselIndex = currentCarouselIndex === 0 ? carouselItems.length - 1 : currentCarouselIndex - 1;
            updateCarouselPosition();
            
            document.querySelectorAll('.carousel-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === currentCarouselIndex);
            });
        }

        function updatePriceCards() {
            const priceCards = document.getElementById('price-cards');
            const vegetables = marketDataAPI.vegetableData;
            
            priceCards.innerHTML = '';
            
            vegetables.forEach(vegetable => {
                const priceCard = document.createElement('div');
                priceCard.className = `price-card ${vegetable.name === selectedVegetable ? 'active' : ''}`;
                priceCard.innerHTML = `
                    <div class="price-icon">${vegetable.icon}</div>
                    <h3 class="price-name">${vegetable.name}</h3>
                    <div class="price-value">${vegetable.currentPrice}/${vegetable.unit}</div>
                    <div class="price-change ${vegetable.change >= 0 ? 'price-up' : 'price-down'}">
                        ${vegetable.change >= 0 ? '+' : ''}${vegetable.change}%
                    </div>
                `;
                priceCard.addEventListener('click', () => selectVegetable(vegetable.name));
                priceCards.appendChild(priceCard);
            });
        }

        function selectVegetable(vegetableName) {
            selectedVegetable = vegetableName;
            document.getElementById('selected-vegetable').textContent = vegetableName;
            
            document.querySelectorAll('.price-card').forEach(card => {
                card.classList.remove('active');
            });
            
            document.querySelectorAll('.price-card').forEach(card => {
                if (card.querySelector('.price-name').textContent === vegetableName) {
                    card.classList.add('active');
                }
            });
            
            updatePriceTrendChart();
        }

        function updatePriceTrendChart() {
            if (!priceTrendChart) return;
            
            const priceHistory = marketDataAPI.getPriceHistoryForVegetable(selectedVegetable, currentTimeframe);
            
            priceTrendChart.data.labels = priceHistory.map(item => {
                const date = new Date(item.date);
                return currentTimeframe === '1M' ? 
                    `Week ${Math.ceil(date.getDate() / 7)}` : 
                    date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            });
            
            priceTrendChart.data.datasets[0].data = priceHistory.map(item => item.price);
            priceTrendChart.data.datasets[0].label = `${selectedVegetable} Price (/kg)`;
            priceTrendChart.update();
        }

        function updateMarketShareChart() {
            if (!marketShareChart) return;
            
            const marketShareData = marketDataAPI.getMarketShareData();
            
            marketShareChart.data.labels = marketShareData.map(item => item.vegetable);
            marketShareChart.data.datasets[0].data = marketShareData.map(item => item.share);
            marketShareChart.update();
        }

        function changeTimeframe(timeframe) {
            currentTimeframe = timeframe;
            
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-timeframe') === timeframe);
            });
            
            updatePriceTrendChart();
        }

        function sendAIMessage() {
            const chatInput = document.getElementById('chat-input');
            const message = chatInput.value.trim();
            
            if (!message) return;
            
            const chatMessages = document.getElementById('chat-messages');
            
            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'message user-message';
            userMessage.textContent = message;
            chatMessages.appendChild(userMessage);
            
            // Clear input
            chatInput.value = '';
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Simulate AI response after a delay
            setTimeout(() => {
                const aiResponse = generateAIResponse(message);
                const aiMessage = document.createElement('div');
                aiMessage.className = 'message ai-message';
                aiMessage.textContent = aiResponse;
                chatMessages.appendChild(aiMessage);
                
                // Scroll to bottom again
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1500);
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Simple response logic based on keywords
            if (lowerMessage.includes('soil') || lowerMessage.includes('ph') || lowerMessage.includes('nutrient')) {
                return `Based on NASA satellite data for your location, your soil pH is ${currentFarmData.soil.ph} and organic matter is ${currentFarmData.soil.organicMatter}%. The soil moisture is ${currentFarmData.soil.moisture}%, which is ${currentFarmData.soil.moisture < 30 ? 'below' : 'above'} optimal levels. Consider ${currentFarmData.soil.moisture < 30 ? 'increasing irrigation' : 'reducing water usage'} for better crop yield.`;
            }
            
            if (lowerMessage.includes('water') || lowerMessage.includes('irrigation') || lowerMessage.includes('moisture')) {
                return `Your water quality analysis shows a pH of ${currentFarmData.water.ph} and TDS of ${currentFarmData.water.tds} ppm. The water is classified as ${currentFarmData.water.quality}. For your current soil moisture of ${currentFarmData.soil.moisture}%, ${currentFarmData.soil.moisture < 30 ? 'increased irrigation is recommended' : 'current irrigation levels appear adequate'}.`;
            }
            
            if (lowerMessage.includes('crop') || lowerMessage.includes('plant') || lowerMessage.includes('grow')) {
                const topCrop = currentFarmData.crops && currentFarmData.crops.length > 0 ? currentFarmData.crops[0].name : 'Wheat';
                return `Based on your location in ${currentFarmData.region} (${currentFarmData.zoneName} zone), I recommend ${topCrop} as your primary crop. It has a ${currentFarmData.crops[0].match}% match with your soil and climate conditions. Other good options include ${currentFarmData.crops.slice(1, 3).map(c => c.name).join(', ')}.`;
            }
            
            if (lowerMessage.includes('weather') || lowerMessage.includes('temperature') || lowerMessage.includes('climate')) {
                return `Current conditions in your area: Temperature ${currentFarmData.air.temperature}C, Humidity ${currentFarmData.air.humidity}%, Air Quality Index ${currentFarmData.air.aqi}. The NDVI vegetation index is ${currentFarmData.ndvi.ndvi}, indicating ${currentFarmData.ndvi.vegetationHealth.toLowerCase()} vegetation health.`;
            }
            
            if (lowerMessage.includes('pest') || lowerMessage.includes('disease') || lowerMessage.includes('insect')) {
                return `Based on climate conditions in ${currentFarmData.region}, pest pressure is currently ${currentFarmData.air.temperature > 25 && currentFarmData.air.humidity > 70 ? 'high' : 'moderate'}. Monitor for common pests in your area and consider integrated pest management strategies. Crop rotation can help reduce pest populations naturally.`;
            }
            
            if (lowerMessage.includes('fertilizer') || lowerMessage.includes('nutrient') || lowerMessage.includes('nitrogen')) {
                return `Your soil analysis shows organic matter at ${currentFarmData.soil.organicMatter}% and nitrogen levels at ${currentFarmData.soil.nitrogen} mg/kg. ${currentFarmData.soil.organicMatter < 3 ? 'Consider adding organic compost to improve soil health.' : 'Your soil organic matter is at good levels.'} For precise fertilizer recommendations, consider soil testing for specific nutrient deficiencies.`;
            }
            
            // Default response
            return "I'm CropLens AI, your agricultural assistant. I can help you with soil analysis, crop recommendations, pest control, water management, and more. Please ask me specific questions about your farming needs, and I'll provide insights based on NASA satellite data and agricultural best practices.";
        }

        function switchAnalysisTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-tab') === tabName);
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.toggle('active', content.id === `${tabName}-tab`);
            });
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize language selector
            setupLanguageSelector();
            
            // Check for saved theme
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            const themeBtn = document.getElementById('theme-btn');
            const icon = themeBtn.querySelector('i');
            icon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            
            // Login form
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            
            // Create account form
            document.getElementById('create-account-form').addEventListener('submit', handleCreateAccount);
            
            // Form toggle
            document.getElementById('form-toggle-link').addEventListener('click', function(e) {
                e.preventDefault();
                toggleLoginForm();
            });
            
            // Password visibility toggles
            document.getElementById('toggle-login-password').addEventListener('click', function() {
                togglePasswordVisibility('password', 'toggle-login-password');
            });
            
            document.getElementById('toggle-new-password').addEventListener('click', function() {
                togglePasswordVisibility('new-password', 'toggle-new-password');
            });
            
            document.getElementById('toggle-confirm-password').addEventListener('click', function() {
                togglePasswordVisibility('confirm-password', 'toggle-confirm-password');
            });
            
            document.getElementById('toggle-account-password').addEventListener('click', toggleAccountPassword);
            
            // Logout buttons
            document.getElementById('header-logout-btn').addEventListener('click', logout);
            document.getElementById('account-logout-btn').addEventListener('click', logout);
            
            // Theme toggle
            document.getElementById('theme-btn').addEventListener('click', toggleTheme);
            
            // Sidebar toggle
            document.getElementById('toggle-sidebar').addEventListener('click', toggleSidebar);
            
            // Navigation
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    navigateToPage(pageId);
                });
            });
            
            // Map controls
            document.getElementById('search-location').addEventListener('click', searchLocation);
            document.getElementById('get-current-location').addEventListener('click', getCurrentLocation);
            document.getElementById('fetch-nasa-data').addEventListener('click', fetchNASAData);
            document.getElementById('save-location').addEventListener('click', saveLocation);
            document.getElementById('more-info-btn').addEventListener('click', showDetailedAnalysis);
            
            // Analysis tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchAnalysisTab(tabName);
                });
            });
            
            // Carousel controls
            document.getElementById('carousel-prev').addEventListener('click', prevCarouselItem);
            document.getElementById('carousel-next').addEventListener('click', nextCarouselItem);
            
            // AI chat
            document.getElementById('send-btn').addEventListener('click', sendAIMessage);
            document.getElementById('chat-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendAIMessage();
                }
            });
            
            // Market trends
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const timeframe = this.getAttribute('data-timeframe');
                    changeTimeframe(timeframe);
                });
            });
            
            // Stat cards (dashboard to analysis navigation)
            document.querySelectorAll('.stat-card').forEach(card => {
                card.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    navigateToPage('analysis');
                    setTimeout(() => {
                        switchAnalysisTab(tabName);
                    }, 100);
                });
            });
        });

        // Initialize the application when the window loads
        window.onload = function() {
            // Check if user is already logged in (for demo purposes)
            const demoUser = localStorage.getItem('demoUser');
            const userData = localStorage.getItem('userData');
            
            if (demoUser || userData) {
                currentUser = demoUser ? JSON.parse(demoUser) : JSON.parse(userData);
                document.getElementById('user-name').textContent = currentUser.name;
                document.getElementById('user-avatar').textContent = currentUser.initial;
                document.getElementById('account-name').textContent = currentUser.name;
                document.getElementById('account-username').textContent = currentUser.username || 'user123';
                document.getElementById('account-avatar').textContent = currentUser.initial;
                document.getElementById('account-login-date').textContent = currentUser.loginDate || new Date().toLocaleString();
                document.getElementById('account-created-date').textContent = currentUser.createdDate || new Date().toLocaleString();
                
                document.getElementById('login-page').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                
                if (typeof google !== 'undefined') {
                    initMap();
                }
                
                // Initialize charts after a short delay
                setTimeout(initializeCharts, 1000);
            }
        };
    </script>
</body>
</html>
